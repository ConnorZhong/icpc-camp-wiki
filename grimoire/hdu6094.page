[题目链接](http://acm.hdu.edu.cn/showproblem.php?pid=6094)

给定一张n\*m个格点的网格图，相邻两个点之间有给定权值，再给定k，问k条边的最小权匹配。

sol：设$w_{i}$为i条边的最小权匹配，那么$w_{1},w{2},\cdots,w_{t}$单调增且下凸。

二分一个斜率p，考虑直线$y=p*x$来切$(i,w_{i})$构成的下凸壳，切点满足$w_{i}-i*p$最小，这时只需找出新边权下的最小权匹配和对应的边数并与k比较大小缩小斜率范围就可以了。

找出最小权匹配考虑直接轮廓线Dp。

另外，斜率只需要整数二分。更重要的是，斜率的取值范围不是$\max(w_{i})$，而是w的权值和，因为可能因为下一条增加的匹配边改变了之前所有的已有匹配边，产生一条1e9与1的交错轨，导致斜率至少要w权值和。

[代码]()

[附官方题解](http://bestcoder.hdu.edu.cn/blog/2017-multi-university-training-contest-5-solutions-by-吉如一/)
