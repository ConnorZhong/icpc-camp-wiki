A. Azrael
=========

**题目：**

现在有一个二分图，左边$k \leq 100$个点，右边$p \leq 100$个点，右边每个点到汇点有一个上界为$1$，费用为$0$的边，源点到左边每个点上界为$1$，费用参数为$c_i$，也就是说流量为$x$的时候，费用为$c_i x^2$，左边和右边某些点有边相连，流量为1。

现在问最小费用最大流。

**题解:**

考虑右边只有一个点，左边每个点都向右边连边的情况。这种情况下每个左边的点都不会满流，而且每个点的导数相同。这给我们提示"一个联通块"的左边的点，导数可能会相同。

但是由于中间的边的多样性，加上左边点流量为1的上界，可能会出现各种断层。可能由于一些点参数太小，导致一条边早早满流，而使得这个联通块分割开来。但是平方函数优美的凸性提示我们可能可以用自适应的爬山法。

一开始我们设置一个导数增量，在每个边都不会满流的情况下，每个边必然导数相同。如果我们在这个导数下进行一次最大流。考虑流完之后每个左边的点是否能有增广路到汇点。如果没有，说明这个点的流量也不会更大了，否则说明还有提升空间。从这个地方我们可以得知哪些点需要加上这个增量，哪些不能。

这个增量不需要设置太大，每次注意增量要设置的不能让一条边满流，不然会有问题。

[Petrozavodsk Winter-2015. Wroclaw A.cpp]()
