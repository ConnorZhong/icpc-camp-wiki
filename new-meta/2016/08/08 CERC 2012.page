B.F.G.I.K.
==========

B. Who wants to live forever? (Done By Miceren)
===============================================

**题目:**

给你一个长度为$n$的01串，现在每一回合这个01串都会发生改变。

假设$s_{i}(j)$代表第$i$个回合第$j$个位置是什么。那么有$s_{i+1} = s_{i}(j - 1)$
\^ $s_{i}(j+1)$，且除了$0~n-1$这些位置以外，其他地方都恒定为$0$。

问是否会存在经过一些回合之后，这个01串会不会再发生变化。

**题解:**

首先，如果这个01串里面还有1，就一定会发生变化（分情况易证）。
那么问题就是会不会变得都是0。

其实这个就等价于这个是不是在某个环以内，因为状态数最多就$2^n$，所以我们就想知道$2^n$回合之后，是不是都是0了。

如果这个01串是环状的，我们可以很快知道，但问题是现在不是环状有点难受。

我们可以构造一下，假如之前的串是$s$，我们现在变成s0s'0，其中$s'$是s的reverse。然后把这个串看成环状就好了，可以发现这个和之前的题目一样。

[CERC 2012 B.cpp](CERC%202012%20B.cpp)

F. Farm and factory (Done By Miceren)
=====================================

**题目:**

现在有一个带权无向图$G = (V, E)$，要求你新建一个点，并且和一些点连边，边权你来定，满足

-   $0, 1$号点到原图中的任意一个点，最短路长度不变

-   使得你新建立的点到所有点的最短路的平均值最小

其中$|V| \leq 1e5, |E| \leq 3e5$

**做法:**

假设新加入的点是$w$.

首先我们肯定可以从$w$到所有点连边，权值待定。因为如果实在不想要这条边我们让这条边的权值为无穷大也不影响答案。

为了下面的说法方便，我们规定一些符号

-   $d_s(u), d_t(u)$分别代表$0, 1$号点到$u$的最短路。

-   $d(u)$代表$u$到$w$的最短路长度。

我们最终目的就是最小化$\sum d(u)$。

根据要满足的条件，我们可以得出一下一些不等式

-   $d(t) + d(u) \geq d_t(u), d(s) + d(u) \geq d_s(u) \forall u \neq s, t$

这是为了根据条件『不改变最短路长度』而设置。

-   $d(t) \geq d_t(u) + d(u), d(s) \geq d_s(u) + d(u) \forall u \neq s, t$

这是为了使得$d(*)$是个合法解的必要条件

-   $d(s) + d(t) \geq d_s(t)$

那么我们认为满足以上条件的，$\sum d(u)$的最小值就是答案。

首先必要性很显然，我们来证明充分性，而这等价于证明$d(*)$确实是一个最短路的可能情况。

反证法，假如$u$到$w$的最短路其实为$d*(u) \le d(u)$。对于多个满足的$u$，我们找一个$d(u)$最小的。

首先我们肯定不会傻到从$w$到$u$连了一条长度小于$d(u)$的边（如果有，把它增加到$d(u)$，对答案不会产生影响）。

那么肯定存在另外一个点从$w$到$u$的经过点$v$，设$u, v$在原图中的最短路为$cost$，则有$d*(u) = cost + d(v) \le d(u)$。

由于当前答案已经是最小的了，所以我们的$d(u)$不能单方面减少，不然肯定要违反某个不等式。一下根据$u$是什么分两种情况

-   $u$是$s$或者$t$，不失一般性，假设为$s$。那么其实就相当于有$d(s) \ge d_s(v) + d(v)$，这个和第二个不等式矛盾。

-   $u$不是$s$或者$t$，那么$d(u)$的降低只会违反第一个不等式，即有$d(s) + d(u) = d_s(u)$，上式imply了$d(s) + d(v) + cost \le d_s(v) + cost$，整理可得$d(s) + d(v) \le d_s(v)$，矛盾。

所以如何在上面不等式的限制下最小化$d(*)$呢？

对于每一个点$u$，我们认为它在二维平面上坐标为$d_s(u), d_t(u)$。

假如我们确定了$d(s), d(t)$，为了最小化$d(u)$,
我们有$d(u) = \max(|d(u) - d_s(u)|, |d(u) - d_t(u)|)$。（这是前两个不等式的限制）

把坐标系旋转，就变成了平面上找一个点，使得距离所有点的哈密顿距离之和最小，这个找中位数就好了。

但是现在还有最后一个问题，就是第三个不等式$d(s) + d(t) \geq d_s(t)$。

可以发现平面上任意一个点都在直线$x + y = d_s(t)$的右上方，所以我们通过找中位数找到的解必然满足了$x + y \geq d_s(t)$这个条件，而且可以发现，$s, t$所代表的两个点的贡献恰好就是$d(s), d(t)$。

至此完成，真是一个写起来8分钟，证明起来30分钟的题目。。

[CERC 2012 F.cpp](CERC%202012%20F.cpp)

K. Graphic Madness
==================

傻叉提，感觉没啥意思。方案唯一，只要check就好。
