F. Namori \[Akigeor\]
=====================

题意:
$n(10^5)$个点，$m(n-1\leq m \leq n)$条边的无向图，一开始每个点都是白色。每次可以挑相邻的两个颜色相同的点反转这两个点的颜色，问将整张图染黑的最小步数。

### $m=n-1$

此时是树。二分图染色，观察某一侧点的时候反色，所以题意就变成了：一开始是一颗黑白相间的树，每次可以将黑色的球往相邻的点上移动。问整棵树反色球的最小移动次数。
首先初始状态和目标状态包含的黑球数量必须一样，否则无解。
考虑每条边的某一侧的子树，如果初始状态有$a$个黑球，目标状态有$b$个黑球，那么这条边上至少会被黑球经过$|a-b|$次。显然这是答案的下界。可以类似树形dp那样构造出解，所以这就是答案。

### $m=n$且环的长度是偶数

任选环上一条边$(u,v)$，假设这条边上$u$到$v$经过了$x$个黑球（负表示反向），那么相当于$u$点的初始状态会少$x$个黑球，$v$的初始状态会多$x$个黑球，在删掉$(u,v)$边后的树上做一遍，答案一定是形如$\sum |x-c_i|$的形式，显然可以三分$x$得到最小答案。判无解类似树的情况。

### $m=n$且环的长度是奇数

任选环上一条边$(u,v)$，$u$和$v$一定在剩下来的二分图中的同一侧。操作$(u,v)$就变成了：在$u$和$v$同时消掉两个球，或者在$u$和$v$同时放下两个球。由于不改变球数的奇偶，所以当目标和初始球数差为奇数时无解。$(u,v)$边的操作次数可以由目标和初始球数差除以2唯一确定，假定为$k$。之后只要在$u$和$v$的初始状态同时放上（消掉）$k$个黑球，做一遍树的情况，加上$k$就是答案。

[code](2016/9/22 F)
