# PE 483 Repeated permutation

https://projecteuler.net/problem=483
题目大意：f(P)表示大小为N的置换P的阶，阶即是环长度的LCM
令g(n)=$(\sum_{P\in S_n}f^2 (P))/n!$
求g(350)
没有模。。要求精确到10位有效数字。。

Camp讲题没听懂qwq。。。蒟蒻求问>=19的质数分组以后，每一组具体是怎么DP的。。>-<然后最后再一次DP把它们合起来吗>-<.

[yzq986 wrote on 2016-05-23T06:40:12]

---

@yzq986#3662 

如果做完之后i能够整除lcm，那就说明取了，否则说明没取。

DP是三维的，有一维滚动了。

状态大概是f\[i][j]表示和为i，lcm为j的贡献。

复杂度应该是O(n^2 )乘上一个1e4左右的数（QAQ没有仔细算，反正可以map压下来。。。）

[twilight wrote on 2016-05-24T09:04:37]

---

@twilight#3665 噢~就是说，每次做完X倍数这一整组以后，压缩状态，即把LCM为X倍数的状态乘个X^2 加到没X倍数的状态咩~

[yzq986 wrote on 2016-05-24T17:16:45]

---

@yzq986#3668 对哒~

[twilight wrote on 2016-05-24T23:31:13]

---

@twilight#3669 多谢巨巨~~qwq刚发现一个小问题。。转移的时候还得枚举一个倍数以及算LCM。。这两个地方有什么好的降复杂度的方法吗。。。

[yzq986 wrote on 2016-05-25T13:57:17]

---

@yzq986#3670 感觉没有啊TAT

[twilight wrote on 2016-05-25T13:59:01]

---

@twilight#3671 搞定啦，多谢巨巨~~

[yzq986 wrote on 2016-05-28T11:11:08]

---

大概就是枚举每组每一种轮换的个数。。然后用组合数算方案。。

在做完第i组之后将i能够整除的lcm从状态中约去并更新到答案中。。。

QAQ感觉讲的不是很清楚。。

[twilight wrote on 2016-05-23T12:16:57]

---

@twilight#3661 qwq怎么判断一组取没取呢。。另外弱问DP是几维的。。以及最后的复杂度qwq

[yzq986 wrote on 2016-05-23T13:49:16]

---

