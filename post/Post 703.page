# Codeforces Round #426 简单题解

# A. The Meaningless Game

题意：$(x, y)$ 可以变成 $(x \cdot k, y \cdot k^2)$ 或者 $(x \cdot k^2, y \cdot k)$，问 $(1, 1)$ 能否变成 $(a, b)$. 

$a, b \leq 10^9$, $350000$ 组数据。

题解：等价于存在 $u, v$ 满足 $a = u^2 v, b = v^2 u$. 那么 $u = a / \sqrt[3]{ab}, v = b / \sqrt[3]{ab}$. 
先计算 $\sqrt[3]{ab}$，再判整除性。

# B. The Bakery

题意：长度是 $10^5$ 的数字串分成 $50$，使得每段不同数字的数量总和最大。

题解：dp. 设 $f(i, j)$ 表示把前 $i$ 个数分成 $j$ 段的最大总和，那么 $f(i, j) = \max_{0 \leq k < i}\{f(k, j - 1) + w(k + 1, i)\}$. 其中 $w(i, j)$ 是 $[i, j]$ 中不同数字的数量。

常见的思路是考虑转移 $(i - 1, j)$，决策 $k$ 的贡献 $g[k] = f(k, j - 1) + w(k + 1, i - 1)$. 那么转移 $(i, j)$ 时，数组 $g[]$ 的变化是在 $[prev(i) + 1, i]$ 增加 $1$，其中 $prev(i)$ 是上一个和 $i$ 相同的数字的位置。
到这里就可以用线段树维护 $g[]$，区间加和求最大值。

另外有两个不用线段树的方法：

1. 设 $f(i, j)$ 的最优决策是 $K(i, j)$，那么 $K$ 是完全单调的（因为 $w$ 是满足四边形不等式的）。可以用完全单调性的一般方法求解。
2. 维护一个可行的决策集合 $k_1 < k_2 < \ldots$，应该有 $g[k_1] > g[k_2] > \ldots$. 在末尾插入就是像单调队列一样弹栈。为了支持后缀区间加法，可以在单调队列里面维护相邻两个 $g[]$ 的差值，那么后缀加的影响只是某一个差值减 $1$，如果这个差值是 $0$，就把前一个删掉。具体细节可以看我的代码。

# C. Ever-Hungry Krakozyabra

题意：定义 $f(n)$ 是数字 $n$ 的十进制表示的所有非 $0$ 数码组成的多重集，求 $n \in [L, R]$ 中不同的 $f(n)$ 数量。

题解：不同的多重集只有 $\binom{27}{9}$ 种，枚举多重集 check。check 有点像数位 dp，想象在十叉树上走，如果不卡着 $L$ 和 $R$，可以 $O(1)$ 返回。

一个 nb 的解法：http://codeforces.com/blog/entry/53567?#comment-376517 大佬.jpg

# D. Red-black Cobweb

题意：$10^5$ 个点的树，边有黑白两色，还有权值。求所有黑白边的比例在 $[\frac{1}{2}, 2]$ 中的路径的边权乘积的乘积。

题解：核心的观察是 $\frac{b}{w} < \frac{1}{2}$ 和 $2 < \frac{b}{w}$ 的路径是不交的，可以分别从所有路经中去掉，之后就是普通的树分治了。

# E. Caramel Clouds

题意：有 $3\times 10^5$ 个区间，第 $i$ 个区间有代价 $c[i]$. 有 $q$ 个询问 $t_i$，找到最小的 $x_i$，使得能够删除最多两个总代价不超过 $m$ 的区间后，$[0, x_i]$ 中至少有 $t_i$ 的长度没被覆盖。

题解：一个死做的题。。。首先可以把数轴离散化，每个离散化后的格子可能被原来的若干区间覆盖，记下覆盖它的区间编号。如果一个格子被超过 $2$ 个区间覆盖，那么它无论如何都不会露出来，之后不考虑这种格子。 从左到右考虑每个格子，研究 $x_i$ 落在这个格子里面，可能成为哪些 $t_i$ 的答案。那么实际上就是要算，选择若干个格子（包含当前这个），使得覆盖这些格子的区间不超过 $2$，选中的格子长度之和的最大值。分情况讨论：

1. 如果当前格子是个空格子，简单。
2. 如果当前格子有两个区间盖住，因为你最多选 $2$ 个区间，所以实际上选的区间就确定了。只要再加上这两个区间单独盖的格子长度即可。
3. 如果当前格子只被区间 $p$ 盖住。那么对于另外一个区间 $q$，有两种情况：
a. $p$ 和 $q$ 没交，那么就是选另外一个区间，代价加起来不爆，且自己的总长度最大。这个只要用一个你喜欢的数据结构维护就好。注意不需要限制他们两个不交，因为如果交了的话是算少了，放在 (b) 里面算就好。
b. 有交，那么 $(p, q)$ 这个区间肯定在前面已经扫描到了，只要在扫描到的时候给 $p$ 和 $q$ 都打上标记就好。

---

https://code.icpc-camp.org/ftiasch/acm-icpc/src/master/codeforces/833-codeforces-round-426

[ftiasch wrote on 2017-07-31T06:33:10]

---

