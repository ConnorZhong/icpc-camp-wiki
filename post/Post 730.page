# 2017 Qingdao Online B Bomberman

题目链接：[HDU 6207 Bomberman](http://acm.hdu.edu.cn/showproblem.php?pid=6207)
题目大意：
 $T$ 组数据，每组数据给出一个 $H$，满足 $1 \leq T, H \leq 100$。题目用 $H \leq |x|+|y| \leq H+1$ 给出了平面上的 $8H$ 个整点，从最高点顺时针标号 $1$ 到 $8H$，现在要炸掉所有的点，每次可以选一个还没炸掉的点将其附近 $3 \times 3$ 个整点位置都炸掉，问期望需要炸多少次，以及在确定第一次炸第 $i$ $(1 \leq i \leq 8H)$ 个点的情况下期望需要炸多少次。

初步分析：这 $8H$ 整点之间构成一个环，每次可以选一个存在的点炸掉标号与它的标号之差不超过 $2$ 的所有点，但是存在 $8$ 个特殊点（标号为 $2, 2H, 2H+2, 4H, 4H+2, 6H, 6H + 2, 8H$）互相不能炸掉对方（特殊点可以被非特殊点和自己炸掉），枚举第一次炸哪个点之后可以转化为区间问题，直接做是 $O(T H^3)$ 的，应该过不去，请问有什么好的办法吗？

[skywalkert wrote on 2017-09-18T07:05:13]

---

@skywalkert#5357 可以本地打表，由于对称性，只要存差不多$H$个数就够了。算了下大概要50k之类的，再做一些压缩应该就够了。

[zimpha wrote on 2017-09-18T07:40:24]

---

@zimpha#5358

当时没想到打表，仰慕。。。确实用对称性可以压到只存 $H + 1$ 个结果，可以 AC，此外当 $H$ 比较大的时候，很多情况的期望值差别在 $5 \times 10^{-7}$ 以内，打出来看了下存 $\min(H + 1, 25)$ 个就可以了。

不过，听代码爷爷说可以优化到 $O(T H^2)$？不知道这可能是怎么做的呢？

[skywalkert wrote on 2017-09-18T09:34:53]

---

菜鸡来问下$O(TH^3)$怎么做。。。

[totoro wrote on 2017-09-18T11:45:19]

---

@skywalkert#5359 
你用 $f[i][j]$ 记录把 $i~j$ 这一段消去的期望，然后一般的三方转移是：
$f[i][j]=\frac{\sum_{k=i}^{j}{(f[i][k-L[k]-1]+f[k+R[k]+1][j])}}{j-i+1}+1$
其中 $L[k]$ 表示 $k$ 这个格子向左能炸多远， $R[k]$ 表示向右。
观察到那个 $\Sigma$ 的两项是可以拆开后递推得到的，于是就把转移变成平方了。

[rowdark wrote on 2017-09-18T12:09:28]

---

@zimpha#5358 你们这样过了么？hdoj限制了只给提交8kb代码呀

[AHdoc wrote on 2017-09-18T14:34:08]

---

@AHdoc#5364 根本没有做，只是提供一个可能可以AC的想法。

[zimpha wrote on 2017-09-18T14:39:28]

---

@AHdoc#5364 hdoj应该是限制了65kb的样子。

[Y_UME wrote on 2017-09-19T02:38:41]

---

