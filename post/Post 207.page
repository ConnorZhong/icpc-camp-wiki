# Nanyang 2015 E Ba Gua Zhen

给定 $n \leq 50000$ 个点，$m \leq 100000$ 条边，边权 $w$ 满足 $0 \leq w < 2\^{60}$  的一个没有重边和自环的无向图。
求任意一条回路的异或的最大值。

[Wangzhpp wrote on 2015-10-20T05:16:32]

---

~~正好在写blog就直接粘过来了~~
任意选定一个起点，从起点出发开始dfs，同时记录路径xor和，每走到一个访问过的点表明得到了一个环，将当前异或值与起点到当前点的xor和xor一下可以得到环上的xor和，由于xor的性质，任意一个回路都可以用前面得到的环来线性表示，于是对之前得到的xor和做一次xor高斯消元，得到一组向量基，令$\mathrm{ans}=0$，枚举每个向量基，用$\mathrm{ans}=\max\\{\mathrm{ans},\mathrm{ans} \oplus \mathrm{base}\\}$更新答案即可，复杂度$O(60(n+m))$。

[quailty wrote on 2015-10-20T05:22:37]

---

@quailty#2000 
这个搞死小圆的复杂度不是$O(m \times 60\^{2})$？你这样算出来的环的数量应该跟$m$是同阶的？这样复杂度不会爆炸吗……

[y761823 wrote on 2015-10-21T05:49:45]

---

@y761823#2040 
位运算可以60合1

[quailty wrote on 2015-10-21T06:46:05]

---

@quailty#2041 搞死小圆！

[ftiasch wrote on 2015-10-21T07:10:46]

---

@quailty#2041 原来如此！明白了，不愧是Q神

[y761823 wrote on 2015-10-21T07:16:38]

---

