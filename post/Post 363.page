# 一个序列问题

给出一个长度为 $n$ 的数字序列，最开始每一个数字都是一类。接下来进行 $n$ 次操作，操作是区间加减或者区间对某一个数取max。
一次区间取max操作修改到的所有数（显然在修改后相同了）都看成是全新的一类。
一次区间加减操作时，如果原来的某一类数中有一部分和操作区间相交，那么看成它分裂成了两类（即产生了新的一类），如果是被包含或者不想交那么看成没影响。
那么可以问一下在最坏情况下操作结束后出现过的数类种数最坏是什么级别的吗？是线性的吗？

----

简单描述的话就是把和它相关的操作序列完全相同的数归为一类，区间取max操作看成把所有要修改的数给删去然后再它们原来的位置插入新数，然后问对 $n$ 个数操作 $n$ 次最多能产生多少类数。

[jiry_2 wrote on 2016-03-04T06:01:51]

---

船比较笨，不知道有没有理解错 QvQ。

如果是一个序列 $1, 2, \ldots, n, n, (n - 1), \ldots, 1$ ，每次只对前一半操作 +，那么岂不是每次都会 + $n$ 个新数？

至于怎么搞出这个数列，只要 $[1, 2n], [2, 2n-1], \ldots$ 取 $n$ 次 max 就行了。

[ftiasch wrote on 2016-03-04T08:27:39]

---

举例来说的话，如果原来的数列是1 2 3 4，那么这时总共有四类数。
第一次操作让区间$[2,4]$对$5$取max，那么得到的序列是1 5 5 5，这时序列中一共有两类数（产生了一个新类，而原来有三类被完全删除了）。
第二次操作让区间$[1,3]$加上$2$，那么得到的序列是3 7 7 5，这时序列中一共有三类数（把原来5这一类给剖开了，产生了一个新类，因为1这一类是被修改区间包含的，所以就不算产生新类）
在这两次操作中一共出现过6类数。

[jiry_2 wrote on 2016-03-04T06:05:26]

---

@Hayashimo#3219 QAQ可能是我问题没有描述好
最开始这个数列的确是第$i$个数和第$n-i+1$个数是一类，但是在对前半部分+了之后，每一类都被分割开了，所有数都单独的作为了一个类，然后再对前半部分＋的时候因为覆盖的都是完整的一类，所以并没有新类产生..
所以这样在操作了$n$次之后类数应该还是线性的吧。
这是我在分析一个奇怪的问题的复杂度的时候遇到的子问题..所以条件长的有点奇怪QAQ

[jiry_2 wrote on 2016-03-04T08:55:26]

---

