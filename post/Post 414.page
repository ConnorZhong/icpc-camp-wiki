# 萌新求助...关于多母串SAM和trieSAM的问题？

听说在把trie建成SAM的时候要按照bfs序建，不然复杂度可能退化？

那在多母串建SAM的时候为什么可以在建完一个串之后直接把last指针指向root呢？这样做的复杂度是要比把这些所有
母串建成trie然后再dfs建SAM的复杂度要高的吧？

求解其中区别orz

[splinter wrote on 2016-05-06T14:44:50]

---

直接乱搞复杂度最坏也只和所有叶子节点的深度之和有关，所以对于多母串来说肯定是没问题的。

[sd_invol wrote on 2016-05-06T19:18:30]

---

后一种方法几乎和你用一种特殊字符(#)把母串隔开连起来以后run一次建SAM的函数是一样的

[fotile96 wrote on 2016-05-07T02:37:59]

---

