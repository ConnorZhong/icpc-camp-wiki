# JAG Practice Contest for ACM-ICPC Asia Regional 2016 Hints

以下是 ICPCCamp 团队所写的非官方题解，感谢大家的帮助和支持。欢迎大家回帖交流。

** 几乎所有题目都未经程序 AC，欢迎质疑。** 

感谢 @NPC @ftiasch @zimpha @Sd_Invol @AngryBacon 在过程中的帮助。

---

官方日文解答 http://acm-icpc.aitea.net/index.php?2016%2FPractice%2F%E6%A8%A1%E6%93%AC%E5%9C%B0%E5%8C%BA%E4%BA%88%E9%81%B8%2F%E8%AC%9B%E8%A9%95

# A. Best Matched Pair

题意：$n$ 个不同的数 $a_1, a_2, \ldots, a_n$，找 $(a_i, a_j)$ 使得 $a_i \times a_j$ 最大同时数位连续单调递增。

$n \leq 10^3, a_i \leq 10^4$

题解：$O(n^2)$ 枚举，题解 $O(n \log n)$

# B. Help the Princess!

题意: 有一个$H \times W$的格子图, 有些位置是空地, 有些位置是障碍物. 若干士兵要抓公主, 一开始每个人的位置都互不相同. 格子图中有个出口, 问公主是否一定能逃出去(不管士兵怎么走).

题解: 求出出口到每个位置的距离, 如果距离公主的距离比距离士兵的距离都小, 那么一定能逃出去, 否则士兵肯定可以先到出口位置等着公主.

# C. We Don't Wanna Work!

题意: ACM协会中有$n$个人, 每个人有个motivation level, 将每个人按照motivation level从大到小排序, 相同的按照入会时间从小到大排序. 协会里面排名在前20%的会努力工作, 剩下80%不工作. 现在有$m$个事件, 加入一个新的成员或者一个成员离开. 每次事件后输出工作状态变化的人. 保证同时只有一个人状态变化.

题解: 应该按照题意模拟就好了.

# D. Parentheses

题意：给出 $A$，求（长度，字典序）最小的，至少并恰好需要交换 $A$ 次相邻字符才可以变成括号序列的括号串。

$A \leq 10^9$

题解：贪心，先算出最小需要的长度。然后从左到右依次确定每一位。复杂度$O(n)$

长度为 $2n$ 的串可以构造出需要 $[0,1+3+...+2n-1]$ 中所有的数，所以长度是单调的。
从左到右贪心着放的时候，右边的A的upper bound就是先放)再放(，这个的upper bound可以O(1)算出来


# E. Similarity of Subtrees

题意：对于有根树 $T$ ，定义 $D(T) = \{S(T, 0), S(T, 1), \ldots, \}$ 其中 $S(T, d)$ 表示 $T$ 中深度为 $d$ 的节点的数量。给出一颗 $n$ 个点的有根树 $T$，$T_v$ 表示以 $v$ 为根的子树，统计满足 $D(T_u) = D(T_v)$ 的 $(u, v)$ 数量。

$n \leq 10^5$

题解：启发式合并维护 $D(T_u)$ + hash 是 $O(n \log n)$ 的，能过吗？

补：不用启发式合并，可以一次 DFS 算出所有子树 Hash 值，复杂度线性。


# F. Escape from the Hell

题意: 天上悬下一根长度为$L$的绳子, 绳子第$N$天之后会被切断. 有$N$个饮料, 喝了第$i$个, 白天能够往上爬$A_i$的距离, 但是晚上会下滑$B_i$. 有个人开始爬, 同时下面有另一个人也开始爬, 这个人第$i$天晚上可以爬$C_i$的距离, 且白天不会下滑. 问第一个人能不能爬到绳子顶上, 且不被第二个人追到. 如果可以输出最早哪天可以爬到顶上.

题解: 记$D_i=A_i-B_i$. 枚举最后一天白天喝哪种饮料$(A_t, B_t)$, 然后删掉这种饮料, 把其他饮料按照$D_i$从大到小排序,$D_i < 0$的显然没有用. 记$SC_i=SC_{i-1}+C_i$, $SD_i=SD_{i-1}+D_i$, 显然只要找到一个最小的$x$满足$SD_i \ge SC_i, i < x$, 并且$SD_x \ge L - A_t$就好了, 这个显然可以二分. 上述过程直接暴力是$O(n^2)$的, 感觉搞个什么东西维护下可以做到$O(n\log n)$.

补：只要枚举完二分的时候当枚举过的东西不存在即可，不用特意用其他数据结构。


# G. Share the Ruins Preservation

题意：二维平面上 $n$ 个点，找一个 $X$，使得横坐标 $\leq X$ 和 $> X$ 的点组成的两个凸包面积和最小。

$n \leq 10^5$

题解：水平序维护一下凸包。

# H. Pipe Fitter and the Fierce Dogs

题意：$H \times W$ 的网格，$(2 i + 1, 2 j + 1)$ 的格子上有房子。现在房子要通水，有两种方式：

在房子里修一个特殊管道，代价是 0，但是总的特殊管道只能有 $K$ 个（给定）；
从房子 $(x, y)$ 往房子 $(x + 2, y - 2) / (x + 2, y), (x + 2, y + 2)$ 修一个普通管道，代价是 1 （对应的管道位于 $(x + 1, y - 1), (x + 1, y), (x + 1, y + 1)$）。另外有 $N$ 个位置有疯狗，如果管道的位置有疯狗，那么代价变为 $2$. 

问最小的总代价。

$H, W \leq 10^4, N \leq 10^5$

题解：

~~首先第一行的房子肯定要修特殊管道的。然后其余每个房子就算一下它从三个方向来需要的最小花费。最后如果特殊管道有多的，就把那些要花得多的房子接上特殊管道。~~

~~补：其实就是一个DAG的最小树形图，对于每只狗考虑它影响的房子，就能计算出有多少个房子连接代价是2，有多少代价是1。然后只需要贪心地把代价最大的K个房子的代价变成 0。~~

# I. Multisect
题意: 有个软件发布了最终版$R_{RC}$, 可是测试失败了, 已知在$R_{PASS}$版本的时候没有问题. 出错的版本在$R_{PASS}+1$到$R_{RC}$等概率出现. 你要找到这个出错的版本$R$ (在$R-1$测试通过, 在$R$测试失败). 已知有$K$个测试人员, 可以同时测试$K$个版本. 同时测试时有$i$个测试失败了, 那么需要花费$T_i$. 求测试出出错版本的最小期望花费.

题解: 

# J. Compressed Formula

题意：以 $(s_1)^{r_1}(s_2)^{r_2}\ldots (s_n)^{r_n}$ 的形式给出一个表达式，只有加减乘，没有括号，其中 $x^y$ 表示 $x$ 重复 $y$ 次，求展开后的表达式的值 mod 1e9+7.

$n \leq 10^4, |s_i| \leq 10, r_i \leq 10^9$

题解：矩阵乘法，维护 3 个东西：前面的单项式的和 s、当前单项式的乘积 pd，以及当前单项式除去最后一个因子的乘积 pd2. 分情况讨论：

遇到加减号，就把 pd 加到 s 上，pd 设成 0，pd2 设成 +1 或者 -1;
遇到乘号，把 pd2 设成 pd，pd 设成 0；
遇到数字 d，实际上应该就是 pd2 * (10 ori + d) = 10 pd2 * ori + pd2 * d = 10 pd + d * pd2. 

快速幂就行。

# K. Non-redundant Drive	

题意：$n$ 个点的树，点 $x$ 上有 $g_x$ 升汽油，边有长度，找一条尽量长的路径，使得一路上的汽油都够用。

题解：树分治，算一个每个点到根能留下多少汽油以及根到每个点最少需要多少汽油。


[ftiasch wrote on 2016-10-03T09:04:27]

---

疯狗题, 观察发现如果没有特殊管道, 相邻两行之间只能自己连自己上面的或者相邻两个房子交换连(连出一个十字叉). 所以DP可知至少需建立几个疯狗管道. 最后把剩余的特殊管道优先用在减少疯狗管道上(观察发现一个特殊管道只能减少1个疯狗管道).

软件测试题, 用DP递推 answer_n. 可以发现不同的n的DP其实是一样的, 所以做一个DP就完了.

[yuzuriha_inori wrote on 2016-10-04T04:51:30]

---

F题如何二分，对于一个i我知道SD[i]>SC[i]，但是我并不知道前面是否都满足SD[j]>SC[j],j<i

[fhy_tan wrote on 2016-10-07T06:25:26]

---

@fhy_tan#4545 $SD[j] - SC[j]$都大于0就好了, 就是再搞个数组$mn[i]=\min(SD[i]-SD[j], mn[i-1])$.

[zimpha wrote on 2016-10-07T09:05:37]

---

@zimpha#4546 但是这样的话，我枚举哪个Di作为最后一天爬的时候，这mn[i]岂不是要重算

[fhy_tan wrote on 2016-10-07T11:48:07]

---

