# 2015 Asia Jakarta J Alien Abduction 3

[题目链接](https://odzkskevi.qnssl.com/6fc4a6c27ef2250940f3bdf68eab0e9f?v=1481573092)
题目大意：
有 $D$ 个字符串集合，每个集合里有不超过 $5$ 个字符串。
保证每个集合内的字符串不同，每个字符串只在一个集合内出现（如果没有给出某个字符串，则这个字符串自己属于一个集合）。
定义替换操作，若字符串 $S$ 能变成 $T$ ，则存在 $S = S_1 + S_2 + \cdots + S_N, T = T_1 + T_2 + \cdots + T_N$ 使得任意的 $i = 1, 2, \cdots, N$ 有 $S_i$ 和 $T_i$ 在同一个字符串集合中， 其中 $S_i$ 和 $T_i$ 都是字符串。
有 $M$ 个询问，每个询问给出两个字符串 $A$ 和 $B$ ，问是否存在一个字符串 $C$ 使得 $A$ 能变成 $C$ 且 $B$ 能变成 $C$ ，若存在则给出字典序最小的 $C$ ，若不存在则输出 [ALIEN] 。
$D \leq 5000, M \leq 100$，保证所有给出的字符串长度不超过 $20$ 。


[skywalkert wrote on 2016-12-19T07:52:59]

---

一个暴力的想法是建一个能接收 $A$ 和 $A$ 能替换的字符串组成的自动机 $DFA_A$ ，再给 $B$ 建一个 $DFA_B$ ，然后就是在两个自动机上同时记忆化搜索得到一个字典序最小的答案，这样的复杂度应该是 $O(26 |DFA_A| |DFA_B|)$ 的。
$A$ 可能有 $210$ 种子串，每个子串可以替换成至多 $4$ 种长度为 $20$ 的字符串，那么 $DFA_A$ 可能会有 $21 + 210 \times 4 \times 19 = 15981$ 个结点，然后就不会做了QAQ。
这个 DFA 可以~~用词法分析那一套理论~~缩缩点得到一个状态最小的等价 DFA ，最坏情况下点数好像还是爆炸了QAQ。

[skywalkert wrote on 2016-12-19T08:15:47]

---

想错了，是NFA

[skywalkert wrote on 2016-12-20T06:02:45]

---

题目描述写错个地方，输出的解是满足长度最小后字典序最小的，这样可以 BFS 。

上面的做法改改就通过了，玄学复杂度，虽然可能是暴力水过去了，不过就这样吧。

在 NFA 上 BFS 有一个 trick 是路径对应的字符串相同的状态应该一起用相同出边去尝试扩展新的状态，这样才能保证 BFS 序列是满足条件的。这题 NFA 转 DFA 实在有点麻烦，可以维护一下 BFS 序列里相邻的状态是否路径相同即可，这个可以在一起扩展状态时标记。

[skywalkert wrote on 2016-12-20T21:29:13]

---

