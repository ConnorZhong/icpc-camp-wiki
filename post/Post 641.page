# Codeforces #371 Problem E. Gosha is hunting

n 个 pokemon，a  个 精灵球, b 个 大师球。
精灵球抓到第 i 个 pokemon 的概率是 p_i
大师球抓到第 i 个 pokemon 的概率是 u_i
每个神奇宝贝可以。
丢一个精灵球，丢一个大师球，各丢一个（只要有一个抓到就算抓到），或者不丢。
问期望最多抓多少个。
n <= 2000 




http://codeforces.com/contest/739/submission/22499628
为什么直接这样二分参数是对的啊。。。


http://codeforces.com/contest/739/problem/E
http://codeforces.com/blog/entry/48582

[xiaodao wrote on 2016-11-29T19:14:05]

---

二分大师球对期望贡献均值的正确性是显然的

dp[x][i] = 考虑前x个精灵(大师球对期望的平均贡献为k的情况下，i个精灵球对期望的平均贡献最大值, 需要的大师球个数)
转移考虑每个精灵考虑用什么球
dp得到的大师球个数是尽可能少的，因为dp最大化的是精灵球的贡献，也就是，尽可能使用精灵球（或者说，k在dp里的贡献是负的）
dp[x][i]只要x>=i, A球一定能用完，这也是显然的…… 

最后，期望可加，所以答案是正确的

---
第一个正经的回复献给岛娘了

[Yangff wrote on 2016-11-30T05:47:26]

---

@Yangff#4814 厉害！

[xiaodao wrote on 2016-11-30T11:49:36]

---

提供一种想法

假设$f(x,y)$表示用$x$个精灵球，$y$个大师球可以得到的最好期望
可以发现当$x$固定时，$f$关于$y$是上凸的，答案需要求$f(a,b)$，我们固定$a$,二分斜率$k$，得到新函数$g(y)=f(a,y) - ky$。
通过观察$g(y)$的最大值所对应的$y$坐标$B$与$b$的相对关系，可以找到最终答案的大师球平均期望(即$k$)，继而可以知道$f(a,b)$的值

[totoro wrote on 2016-12-01T14:34:09]

---

