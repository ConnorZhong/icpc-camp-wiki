# 树中最近点对

现有一棵树，根节点为黑色，其余结点为白色。支持两种操作：
1.每次将一个结点变成黑色；
2.询问某个点u，求离这个点最近的黑点的距离。
范围均为1e5级别。
求教怎么做。

[rootial wrote on 2016-03-18T05:16:00]

---

先树分治一下, 然后保留下树分治的结构, 这个树分治结构要维护子树中黑点到重心的最小距离.

对于修改操作, 这个点所属的重心, 直接更新最小值.

对于查询操作, 同样枚举这个点所属的重心, 利用之前记录的最小值更新就好了.

时间复杂度$O(n\log n)$

[zimpha wrote on 2016-03-18T07:11:21]

---

@zimpha#3368  每次需要求子树重心和上一级树重心的距离，这样似乎是O(n*logn*logn)的？

[rootial wrote on 2016-03-18T10:54:45]

---

@rootial#3378 距离可以事先存下来

[zimpha wrote on 2016-03-18T12:17:21]

---

@zimpha#3379 似乎不能直接把各级重心之间的距离直接累加。

[rootial wrote on 2016-03-18T12:19:09]

---

@rootial#3380 我懂了，因为每个重心上一级的重心不会超过logn个、

[rootial wrote on 2016-03-18T12:23:11]

---

