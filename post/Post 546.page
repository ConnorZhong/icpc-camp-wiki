# 2016 ICPC 大连网络赛题解

** 免责声明：以下题解是 ICPCCamp 团队所写的非官方题解，by xxx 表示的是题解作者，并不是出题人，谢谢！**

感谢 @NPC  @Sd_Invol @zimpha @Nero @rowdark @AngryBacon 在过程中的帮助。

很惭愧，03 04 05 暂未取得 AC，在通过之后会及时补上。[UPDATE: 已更新，见 https://async.icpc-camp.org/d/553-2016 ]

---

# 1001 Different Circle Permutation [by sd0061]

题意：n 个点构成一个环，每个点可以染色为黑色或白色，要求任意两个相邻的点不能都是黑色，问在旋转同构意义下的染色数。

题解：

设 $f(n)$ 为不考虑旋转同构时给 n 个点的环染色的方案数，显然有递推式 $f(n) = f(n-1) + f(n - 2)$。这个可以靠矩阵来$O(\log n)$求一次 $f(n)$。

考虑旋转则根据 burnside 引理有 $F(n) = \frac{1}{n}\sum_{i=1}^{n}f(\gcd(i , n))$。

即 $F(n) = \frac{1}{n}\sum_{d|n}{f(d) \varphi(\frac{n}{d})}$，枚举 $d$ 运算即可，复杂度为$O(\sqrt{n}\log n)$。

注意还要特判 $n=1$ 的情况，因为题意要求是”任意两人”，所以一个人坐在单独的一个座位上仍然是合法的。

# 1002 Different GCD Subarray Query [by Nero]

题意：长度n的序列, m个询问区间[L, R], 问区间内的所有子段的不同GCD值有多少种.

题解：考虑固定左端点的不同GCD值，只有不超过logA种, 所以事件点只有nlogA个. 那么离线处理, 按照区间右端点排序从小到大处理询问, 用一个树状数组维护每个GCD值的最大左端点位置即可. 复杂度是O(nlogAlogn).


# 1006 Football Games [by zimpha]

题意: 有$m$组球队, 每组有$b_i$支球队. 每组之间两两踢球, 赢得加2分, 平手各加1分, 输的不得分. 现在告诉你每组里面每只球队最后的分数, 问这个分数序列是否正确. 

题解： 

如果没有平手选项, 赢得加一分的话, 可以用[Landau's Theorem](https://en.wikipedia.org/wiki/Tournament_(graph_theory))判定, 这题稍微修改下这个定理就好了. 令$s_1,s_2,...,s_n$是他们的得分序列, 从小到大拍个序, 使得$s_1 \le s_2 \le ... \le s_n$, 那么这个序列合法, 当且仅当: 

1. $s_1+s_2+...+s_i \ge i(i-1)$, 对于所有$1 \le i \le n - 1$
2. $s_1+s_2+...+s_n=n(n-1)$. 

# 1007 Friends and Enemies [by zimpha]

题意: 有$n$个人, $m$种颜色的石头, 人两两之间要么是朋友, 要么是敌人. 每个人可以携带若干种石头或者不带, 要求朋友之间至少携带一种颜色相同的石头, 敌人之间不能携带有相同颜色的石头. 问最坏情况下, $m$种颜色是否够. 

题解： 

Nero搞出了一个结论: $n$个点的图, 要求有尽量多的边, 并且不存在三元环. 这个边数就是$m$的下界. 

对于一个$n$个结点的没有三元环的图, 边数最大的就是完全二分图. 于是答案就是$\lfloor \frac{n}{2} \rfloor \cdot \lceil\frac{n}{2} \rceil$.

# 1008 Function [by ftiasch]

题意：给出 $a_1, a_2, \ldots, a_n$ 和 $q$ 个询问 $[i, j]$ 表示询问 $a_{i} mod a_{i + 1} mod \ldots mod a_{j}$ 的值。

题解：

如果 $a \geq b$，那么 $a mod b \leq \frac{a}{2}$. 
所以，如果使用线段树每次找到下一个不超过当前余数的数。因为每次余数减少至少一半，复杂度应该是 $O(q \log n \log A_i)$.
实际上，上述做法会因为常数原因 TLE.

一个容易实现的方法是：把 q 个询问一起进行。我们可以拿 std::set 按照当前余数大小从大到小排序，每次比 a[i] 大的肯定是 std::set 中最大的若干元素，暴力修改它们即可。

# 1009 Sparse Graph	[by ftiasch]

题意：n 个点的无向完全图中删除 m 条边，问点 s 到其他点的最短路长度。

题解：

补图上的 BFS 是非常经典的问题。一般的做法是用链表（或者偷懒用 std::set）维护还没 BFS 过的点。当要扩展点 u 的时候，遍历一次还没访问过的点 v，如果 uv 没边，那么将 v 入队。否则将 v 留在未扩展点中。

很明显，后者只会发生 m 次，前者只会发生 n 次，所以复杂度是 $O(n + m)$.


# 1010 Weak Pair [by zimpha]

题意: 给出一棵$n$个结点的树和一个数$k$, 每个节点上有权值$a_i$, 问有多少个有序对$(u,v)$满足$u$是$v$的祖先, 且$a_u \times a_v \le k$. 

题解： 

从根开始dfs, 用treap维护当前节点$u$到根的节点权值序列, 然后就在treap上查询小于等于$\frac{k}{a_u}$的数的个数. 之后把$a_u$加到treap中, 退栈的时候把$a_u$从treap中删除. 复杂度是$O(n \log n)$的.


[ftiasch wrote on 2016-09-10T08:59:59]

---

请问1006为什么修改Landau's Theorem是正确的？

[hccz95 wrote on 2016-09-10T12:11:58]

---

 请问1001里这个式子$F(n) = \sum_{i=1}^{n}f(\gcd(i , n))$是怎么得出来的?
$i$的意义是什么？

[asdfghj wrote on 2016-09-10T13:02:50]

---

@DPSleeper#4209 就是 burnside 引理嘛……枚举旋转 $i$ 次剩下的等价类就只有$\gcd(n,i)$种，方案就是这些的平均数

[sd_invol wrote on 2016-09-10T13:32:40]

---

@DPSleeper#4209 原来写错了。。现在改对了。。就是 Burnside's Lemma 套一下

[ftiasch wrote on 2016-09-10T13:33:04]

---

原来1006过辣么多人是数据水了，怎么感觉最近遇到好多这些见都没见过纯英文解说的定理题啊/(ㄒoㄒ)/~~

[fhy_tan wrote on 2016-09-11T06:46:51]

---

叉姐叉姐，一般对于06这种定理题一般你们是从哪里学到的，是否有什么相关书籍什么的

[fhy_tan wrote on 2016-09-11T07:03:29]

---

1005怎么写

[evilgeek wrote on 2016-09-11T07:39:05]

---

@evilgeek#4219 不会啊。。

[ftiasch wrote on 2016-09-11T07:51:15]

---

@fhy_tan#4218 呃，一般只是恰好看到了吧。。比赛中一般的定理题都是 yy 一下就可以做出来的。

[ftiasch wrote on 2016-09-11T07:51:46]

---

@ftiasch#4220 额，哎，看别人博客说了一通，写了一点很短的代码，额其实感觉就是直觉类型的解法，额，而且L是k的倍数肯定是很强的限制条件啊，好想知道怎么证明额。

[evilgeek wrote on 2016-09-11T08:04:45]

---

@ftiasch#4220 额，还有1001中不考虑旋转同构的时候f(1) = 2,f(2) = 3,f(3) = 4,不满足递推式吧，递推式不是给的链的递推式？（我有没有想错？）

[evilgeek wrote on 2016-09-11T08:21:29]

---

@evilgeek#4222 求个博客地址？

[ftiasch wrote on 2016-09-11T08:27:59]

---

@evilgeek#4223 如果我没理解错的话，这个递推式确实是链上的，计算环的只要枚举一个点进行染色就可以破环成链（大概还要特判n=1和2？

[quailty wrote on 2016-09-11T08:28:30]

---

@ftiasch#4224 http://blog.csdn.net/kopyh/article/details/52496579 

[evilgeek wrote on 2016-09-11T08:33:12]

---

@quailty#4225 嗯，链是f(n) = f(n - 1) + f(n - 2),环g(n) = f(n - 1) + f(n - 3)（是这样吧？）

[evilgeek wrote on 2016-09-11T08:35:16]

---

@evilgeek#4226 他评论下面就有个反例。。

[ftiasch wrote on 2016-09-11T09:52:16]

---

@evilgeek#4223 不按照题意的情况下是满足的，就是一个点自己也和自己相邻。

f(1) = 1 , f(2) = 3 , f(3) = 4 , f(4) = 7 ....

只是最后得特判个 1 而已

[sd_invol wrote on 2016-09-11T10:34:25]

---

@ftiasch#4229 可是那个人根本就没有看到L ％ k ＝＝ 0的限制，出的反例有问题。

[evilgeek wrote on 2016-09-11T10:45:48]

---

@evilgeek#4232 这不是重点啊。。

h=5, k=11, L=33，他算出来要 5 排，实际上只要 4 排。。

[ftiasch wrote on 2016-09-11T10:54:28]

---

@ftiasch#4233 那如果加一个判最后比前面空余的小不小的判断会不会对呢

[evilgeek wrote on 2016-09-11T11:02:33]

---

欸，1006我从小到大排序
设当前队编号为p，设个指针为p+1，然后
p>1，每次p-=2，指针右移一位
p==1，指针指向的队-=1
p==0，从指针开始到n，都减去2
如果出现一个数小于0，判错，
如果最后一个数非0，盘错
其他判对，这样做有反例吗

[chendl111 wrote on 2016-09-12T07:05:59]

---

@chendl111#4238 0 4 4 4这组？

[fhy_tan wrote on 2016-09-13T03:22:52]

---

@fhy_tan#4247 可以过，输出T
0 4 4 4—>0 2 2 2—>0 0 2 0—>0 0 0 0,输出T

[chendl111 wrote on 2016-09-13T06:25:06]

---

@chendl111#4248 按你这说法 0 4 6 4岂不是也是T？

[fhy_tan wrote on 2016-09-16T03:59:18]

---

想请问下01的复杂度是怎么算的？

[mzhq wrote on 2016-09-16T07:15:13]

---

@mzhq#4284 约数个数？

[ftiasch wrote on 2016-09-16T07:24:10]

---

