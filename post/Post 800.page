# Petrozavodsk Summer 2017 Warsaw U Contest F. Ants

题目大意：有一棵 $n$ 个点的树，第 $i$ 条边有一个长度 $d_i$。有 $m$ 只蚂蚁，第 $i$ 只蚂蚁会在时刻 $t_i$ 出现在点 $a_i$，然后移动到另一个点 $b_i$，每单位时间移动一个单位长度，这里假设到达 $b_i$ 的时刻是 $t'_i$。任意两只蚂蚁 $i$ 和 $j$ 可能在时刻 $t \in [t_i, t'_i] \cap [t_j, t'_j]$ 于树上某个点或某条边上的某个位置相遇，请你对于每只蚂蚁 $i$ 计算它在某个时刻能相遇到的蚂蚁数量最大值。

数据范围：$1 \leq n, m \leq 10^5, 1 \leq d_i, t_i \leq 10^9, a_i \neq b_i$。

[skywalkert wrote on 2018-04-27T21:04:35]

---

口胡一下……不保证正确性。

首先，轻重链剖分，每只蚂蚁会出现在 $O(\log n)$ 条链上。其次，考虑某一条链，变成一维问题。画一个横轴是 $t$，纵轴是 $x$ 的图，那么每个蚂蚁的轨迹是一条斜 45 度的线，很容易查询了？

@skywalkert#5645 求 check.

[ftiasch wrote on 2018-04-30T10:28:37]

---

