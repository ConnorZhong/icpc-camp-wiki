# AIM Fund Round 简单题解

# A. Graph and String

考虑给出的图 $G$ 的补图 $\bar{G}$，可以发现 $\bar{G}$ 由一个完全二分图和一些孤立点组成，那么只要先把孤立点去掉，再对剩下的图进行二分图染色即可。

# B. Array GCD

注意到 $a_1$ 和 $a_n$ 不会全被删掉，不妨假设 $a_n$ 被留下了。首先枚举 $a_n$ 最后变成了 $a_n - 1, a_n, a_n + 1$ 中的哪一个，假设是 $x$，再枚举 $x$ 的一个**质因数** $d$，剩下的任务就是找一个区间 $[i, j)$ 使得 $$ c_1 + c_2 +  \cdots + c_{i - 1} + (j - i) \times a + c_{j} + c_{j + 1} + c_{n - 2} $$ 最小。其中 $c_i$ 是把 $a_i$ 这个数变成 $d$ 的倍数的代价。

# C. Electric Charges

首先二分答案 $D^2$，假设 $x_1 \leq x_2 \leq \cdots \leq x_n$，那么最优方案一定是存在 $[i, j)$ 使得 $[i, j)$ 区间内的点都落在 $Y$ 轴上，区间外的点都落在 $X$ 轴上。预处理出 $p_i$ 和 $P_i$ 表示 $[0, i)$ 中 $y$ 的最小、最大值，$s_i$ 和 $S_i$ 表示 $[i, n)$ 中 $y$ 的最小、最大值。那么一对 $[i, j)$ 合法，当且仅当满足以下条件：

1. $x_{j - 1} - x_i \leq D$

2. $\max\{P_i, S_j\} - \min\{p_i, s_j\} \leq D$

3. $\max\{p_i^2, P_i^2, s_j^2, S_j^2\} + \max\{x_i^2, x_{j - 1}^2\} \leq D^2$

但是这看上去太复杂了。其实可以根据对称性假设 $|x_i| \geq |x_{j - 1}|$，那么如果从小到大枚举 $i$，

1. 满足条件的 $j$ 单调递增；

2. 满足条件的 $j$ 单调递减；

3. 后面的 max 中只有 $x_i$，然后 $p_i, P_i$ 这两项容易 check，满足条件 $j$ 单调递减；

4. 满足 $|x_i| \geq |x_{j - 1}|$ 的 $j$ 单调递减。

总之可以 $O(n)$。

# D. Birthday

首先需要搞明白的是「策略是什么」，原则上策略 $S$ 可以看做是从「已知的情况」到「猜测」的一个函数。由于题目中的人唯一已知的情况是现在是第几次猜测，所以题目的策略 $S$ 实际上就是一个**固定**的猜测序列 $s_1, s_2, \cdots, $。

之后的关键是有一个量化的方式表示最终的期望。因为知道 $E[X] = \sum_{k = 1}^\infty \Pr[X \geq k]$，经过一番计算（……）就能知道 $$\Pr[X \geq k] = 1 - \prod_{i = 1}^n\left(1 - (1 - p_i)^{c_i(k)}\right)$$
其中 $c_i(k)$ 是前 $k$ 次猜测中猜 $i$ 的次数。

感性地说，为了让 $E[X]$ 最小，其实就是要让乘积尽量地大。因为每轮可以选择一个 $c_i$ 增加 $1$，其实只要贪心地每次增加最大的就行。因为 $p_i$ 最小是 $0.01$，$0.01^{4000}$ 已经非常接近 $1$，所以在 $4\times10^5$ 轮后对答案的影响就很小了。

# E. Transforming Sequence

设 $f_n[x]$ 表示 $n$ 步后 $x$ 个位是 $1$ 的方案数，可以得到
$$f_{2n}[x] = \sum_{i = 0}^{x} \binom{x}{i}  f_n[i] f_n[x - i] (2^{n})^i$$
上面式子的解释是考虑前 $n$ 步已经得到了 $x$ 个 $1$ 中的 $i$ 个，这里有 $\binom{x}{i}$ 种方法。对于已经选择的 $i$ 个 $1$ 来说，后面的 $n$ 步任意，有 $2^{ni}$ 种可能。
把上式改写一下变成
$$\frac{f_{2n}[x]}{(2n)!} = \sum_{i = 0}^{x} \frac{f_n[i] (2^n)^i}{i!} \frac{f_n[x - i]}{(x-i)!}$$ 就可以看出是卷积了。之后 FFT 或者分治乘法都可以。

---
[链接：我的代码](http://git.icpc-camp.org/ftiasch/acm-icpc/tree/master/codeforces/623-aim-tech-round)

[ftiasch wrote on 2016-02-11T10:27:11]

---

@Varona#3129 您“固定的猜测序列”那里数学公式是不是手滑了。。。

[SCaffrey wrote on 2016-02-11T11:12:57]

---

@SCaffrey#3131 fixed

[ftiasch wrote on 2016-02-11T11:15:17]

---

请问E里面如何保证生成的序列是严格递增的呢？ 通过设置初始值F[n, 0] = 0么？

[续一秒 wrote on 2016-02-11T12:16:02]

---

@续一秒#3133 确切地说是 $f_1[0] = 0$。

[ftiasch wrote on 2016-02-11T12:31:08]

---

