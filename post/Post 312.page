# SEERC 15 B Tree of Almost Clean Money

给一颗树, 50000的修改和询问, 修改是每次把树上1000个点的权值加一个数, 询问是询问树上路径点权值和. 修改的操作是自己通过随机产生的. 不会做, 已知一个log的做法会TLE. 求教, 如何搞定那个5000w. (离线? 还是lazy一下? 能不做的尽量先不做?) 题目: http://codeforces.com/gym/100818/attachments

[yuzhou627 wrote on 2015-11-29T15:19:55]

---

我们去维护那棵树的dfs序，维护每个点到跟的权值和，那么修改一个点权影响的是一个区间，就变成了区间询问单点求职的问题。

然后修改有5e7个……询问有5e4个，所以可以考虑分个块……让修改是O(1)的，询问就是问个前缀和就好了。

[sd_invol wrote on 2015-11-29T16:37:52]

---

@Sd_Invol#2926 求教如何分块儿让修改变成O(1)…

[aclsh wrote on 2015-11-29T23:54:58]

---

@aclsh#2927 @Sd_Invol#2926 

其实还有一些别的玩法……比如说平时的线段树是 $d = 2$ 叉的，这样插入复杂度是 $\log\_d{n}$，而询问复杂度应该是 $d \log_d{n}$。那么假如说……我们把 $d$ 变成，16？

[ftiasch wrote on 2015-11-30T00:26:41]

---

@Varona#2929 16叉线段树…怎么把多点更新O(1)实现…

[aclsh wrote on 2015-11-30T01:48:16]

---

@aclsh#2927 维护俗称的差分序列呀，区间修改就是前面加一个后面减一个，单点询问就是一个前缀和。

[sd_invol wrote on 2015-11-30T03:38:11]

---

