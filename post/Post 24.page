# 2015 长春赛区网络赛 C Aggregated Counting

T_T求教这题正确姿势，虽然各种推性质但是搞了半天还是GG了……

[quailty wrote on 2015-09-13T06:33:43]

---

答案就是$\displaystyle\sum_{i=1}^n{i \cdot a_i}$, $a_i$就是题目给出的序列

[zimpha wrote on 2015-09-13T06:49:11]

---

@zimpha#151 Orz……请教一下这个求和式要怎么比较快的计算……

[quailty wrote on 2015-09-13T06:55:10]

---

这个求和式写出来是这样的
1 × 1 + 2 × 2 + 3 × 2 + 4 × 3 + 5 × 3 + .....然后压缩一下, 1 × 1 + (2 + 3) × 2 + (4 + 5) × 2 + (6 + 7 + 8) × 3...
括号内就是个等差数列, 项数就是$a_i$, 于是就可以$\sqrt n$乱搞了

[zimpha wrote on 2015-09-13T07:07:25]

---

把每个数字的范围预处理出来，做个前缀和。。二分搞一搞就好了。。。

[ZJiaQ wrote on 2015-09-13T07:08:30]

---

Orz……多谢各位巨巨的耐心指教

[quailty wrote on 2015-09-13T07:09:45]

---

噗……我才不会说我是非常挫的打表找规律+离线分块打表过掉的……
公式怎么猜都一样。
然后预处理出原序列 $a[ i ]$ 的前缀和 $sum[ i ]$（即题目里要求的，n最后一次出现的下标$last( n )$），之后充分利用$last(i-1)$~$last(i)$之间的数p所乘的a[p]是一致的这点，加快计算。如果每20万打一个数，平均每次查询1000次计算就可完成的感觉。

[toraoh wrote on 2015-09-13T13:45:22]

---

@zimpha#157 巨巨，括号里面是个等差，但是怎么确定首项和项数啊

[FlyingFatty wrote on 2015-09-17T15:10:23]

---

@FlyingFatty#315 因为这个数列本身是1个1,2个2,3个3...这样的，所以这个等差的首项和项数是很好确定的

[winoros wrote on 2015-09-17T15:15:49]

---

@winoros#317 我再想想哈，谢巨巨

[FlyingFatty wrote on 2015-09-17T15:59:56]

---

@zimpha#157 看起来, 并不是$n^{0.5}$, 而是$n^{0.618}$?

[yuzhou627 wrote on 2015-09-24T14:49:39]

---

