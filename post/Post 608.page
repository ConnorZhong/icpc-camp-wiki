# 2016 沈阳现场 H题

大致题意：掷骰子（6面分别为1~6），以骰子朝上的面的点数构造一个序列A。现有N个人，每个人猜测一个长L的数字序列，当某次掷完骰子之后，某个人猜测的序列是A的子串时，这个人就赢了。求每个人赢的概率。1<=N<=10,1<=L<=10。输出保留6位小数。

这题该怎么做QAQ

[SnowyJune wrote on 2016-10-24T16:52:19]

---

一个显然的事实是如果一个人获胜了，那么他猜测的序列一定是A的后缀。
如果我们对这N个人的数字序列建立一个AC自动机的话，那么这个题就变成了在一个可能有重边有自环的有向图中，一开始站在起点，除了终止点之外每个点有6个后继（可能重复），如果在终止点就停留不动，否则每次以1/6的概率选择一个后继走过去。问最终停留在每个终止点的概率分别是多少。~~这是一个经典问题，可以用高斯消元解决。~~
可也以用矩阵来转移计算走n步之后停留在某个点的概率，大概1e18步之后也能保证精度。~~用矩阵快速幂来做也是兹辞的？~~

[QAQ wrote on 2016-10-25T01:08:55]

---

@QAQ#4636 多谢orz。不过每个点有6个后继是怎么得出来的呢QAQ没想太明白
（我好菜啊）

[SnowyJune wrote on 2016-10-25T11:53:38]

---

@SnowyJune#4645 骰子有6个面啊

[zimpha wrote on 2016-10-25T12:00:34]

---

@zimpha#4646 但是如果只对猜测的序列建立自动机的话，可能存在没有人猜的面啊

[SnowyJune wrote on 2016-10-25T13:19:01]

---

@SnowyJune#4650 你建自动机时会把没有的后继补上啊, 补成6个啊

[zimpha wrote on 2016-10-25T16:23:18]

---

感觉是原题（+论文题？）
BZOJ1444，和贾教的有限状态自动机论文例题里都有吧。

[Wangzhpp wrote on 2016-10-26T07:12:42]

---

生成函数也可以做，具体数学8.4

[mikantsumiki wrote on 2016-10-26T09:24:49]

---

