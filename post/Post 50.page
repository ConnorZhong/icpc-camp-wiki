# 2015 沈阳赛区网络赛 B Best Solver

考虑$a_x=(5+2\sqrt6)^x-(5-2\sqrt6)^x$
这个很容易让人想到二阶常系数线性递推，根据伟达定理容易知道$a_x=10a_{x-1}-a_{x-2}$
因为系数都是整数，而且考虑到$0<5-2\sqrt6<1$，故$a_x$即$(5+2\sqrt6)$的整数部分。
那么答案就是$a_{2^x+1}\ mod\ M$
然并卵，$x$很大，费马小定理对这个矩阵也不成立。
而$M$很小，根据fib数列的循环节不超过$6M$的性质，大胆猜测${a_n\ mod\ M}$的循环节很小，为$O(M)$级别。
于是做法就变成了对于一个$M$暴力找循环节(hash啥的，或者floyd判循环节啥的)，然后随便做了。
这样单组数据复杂度$O(循环节长度)$。
不幸的是tle了。
于是我们选择了打表，然后艰难地卡着常数和代码长度限制过去了(打表发现循环节在模数不超过$5*10^4$确实不会太大)
比赛结束后问了我校另一队的做法，结果也是打表……

现在问题是
1.为啥循环节这么短
2.有不是打表过的么


[mikantsumiki wrote on 2015-09-19T15:23:57]

---

http://blog.csdn.net/ACdreamers/article/details/25616461 >_>

[winoros wrote on 2015-09-19T15:27:59]

---

我们用的循环节是 $(P^2 - 1)$。实际上要么是 $2P - 2$ 要么是 $P + 1$。

所以我们就是先摸 $(P^2 - 1)$，之后倍增的。

[ftiasch wrote on 2015-09-19T15:38:08]

---

我们使用了BSGS暴出了它的循环节。

方法和[Changsha 2013](http://acm.zju.edu.cn/onlinejudge/showContestProblem.do?problemId=5064)的D是一样的。

[sd_invol wrote on 2015-09-19T15:54:44]

---

@winoros#373 我们就是完全按照这个blog的结论写的.2333

[yuzhou627 wrote on 2015-09-19T23:01:17]

---

赛后在HDU上提交……暴力找循环节居然625ms过了！

[Wangzhpp wrote on 2015-09-21T03:57:23]

---

