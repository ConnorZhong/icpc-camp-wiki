# 2016 杭州解题报告

免责声明：以下为 ICPCCamp 团队撰写的简要~~题解~~提示，大部分未经程序验证，如有错误，欢迎指出。

感谢 @xiaojudou @ftiasch @rowdark @sd_invol @zimpha 的贡献。

---

## Problem A. ArcSoft’s Office Rearrangement
题意：长度为$n$的数组: $a_1, a_2, \cdots$, 每次操作要么可以merge两个相邻的数为一个, 值为两个数的和; 要么可以把一个数分裂成两个, 两个数的和为原数. 用最少的操作把数组变换成长度为$K$且所有数值相等的数组, 无解输出$-1$。


题解：设 $P = \frac{\sum{a_i}}{K}$，只需要看 $a_i$ 的前缀和有多少个是 $P$ 的倍数。多少个就能省下那么多次分裂再合并的操作。


## Problem B. Bomb
题意：二维平面上有 n 个炸弹，每个炸弹有个引爆的代价和爆炸半径，问至少花费多少代价才能引爆所有炸弹。


题解：建图后缩点，只要对每个入度为 0 的强连通分量里面找到一个代价最小的炸弹引爆就好了。


## Problem C. Car
题意：有个老司机在开车, 开车过程中车的速度是不减的. 交警记录了这个老司机在$n$个时间点的位置, 但是时间位置. 已知老司机从位置0出发, 记录的时间点都是整数, 问经过第$n$个位置最少需要的时间.


题解：通过最后一段路程的时间肯定为 1 秒，只需由速度不降原则倒推出每一段所通过的最小整数时间即可。


## Problem D. Difference
题意: 令$f(y,K)=\sum\limits_{z \text{ in every digits of } y} z^K$, 给出$x$和$K$, 问有多少$y>0$满足$x=f(y,K)-y$.


题解：对每个 $K$ 分开做，把数位折半，分别枚举前一半与后一半的取值，对于每个询问的 $x$ 把前一半和后一半拼起来即可。


## Problem E. Equation 
题意: 有$1 \sim 9$数字各有$a_1, a_2, …, a_9$个, 有无穷多的+和=. 问只用这些数字, 最多能组成多少个不同的等式$x+y=z$, 其中$x,y,z \in [1, 9]$.


题解: 计算下可以发现, 等式最多只有$36$个. 然后每个数字的上界是$\{16, 15, 14, 13, 12, 11, 10, 9, 8\}$. 可以预先判掉答案一定是$36$的, 然后直接暴力搜索每个等式要不要就好了.


## Problem F.  Four Operations
题意: 给出一个长度最大是$20$的数字串, 你要把数字串划分成$5$段, 依次填入’+’, ’-’, ’*’, ’/’, 问能得到的最大结果.


题解:  预处理出前面两个数的最大值, 以及后面三个数的最小值, 枚举减号的位置就好了.


## Problem G. Game of Eliminate
题意: 给出一个$N \times M$的格子, 每个格子是’#’或者’*’, 可以用L和L的镜像消最后两行的格子, 消掉的格子后, 上面的格子会掉下来. 问消完所有’*’的最小步数.


题解：$dp(i, j)$ 表示考虑到第 $i$ 列，前面的 L 已经吃掉了 $j$ 个格子。转移的话可以暴力枚举用了 $x$ 个 L 和 $y$ 个反 L，也就是 $dp(i + 1, k)$ 等于 $dp(i, j) + x + y$ 的最小值，要求 $j + 2x + y \geq a_i$，$x + 2y = k$.


考虑用 $x + 2y = k$ 代入前面，就有 $3y \leq j + 2k - a_i$. 大致上就是说可以用 $dp(i, j) + k - y = dp(i, j) + k - \lfloor \min\{ \frac{k}{2}, \frac{j + 2k - a_i}{3} \} \rfloor$ 来更新。这个根据 j mod 3 讨论一下就行。


## Problem H. Hazy String


题意：长度为 $L$、字符集为 $K$ 的字符串 $S$，固定其中 $N$ 个位置 $p_1, p_2, \ldots, p_N$，问没有长度 $> 1$ 的回文子串的字符串 $S$ 数量。


题解：等价于 $S_{i} \notin \{S_{i + 1}, S_{i + 2} \}$.


如果字符串 $S$ 除了 $S_1, S_2, S_{n - 1}, S_n$ 之外都未知，那么满足条件的数量只跟 $\{S_1, S_2, S_{n - 1}, S_n\}$ 的最小表示有关，可以通过矩阵快速幂计算。


设 $dp(i, j)$ 表示考虑到位置 $p_i$，其中 $p_i + 1$ 位置的字符是 $j$ 的方案数（这里 $j$ 只有 $O(n)$ 种可能），转移时枚举 $p_{i + 1} + 1$ 位置的字符 $k$，依据上面的性质，中间的填法依据 $k$ 只有 $4$ 种可能，可以部分和转移。


复杂度是 $O(n^2)$.


## Problem I. Inequality


题意：给出一个长度为 $n-1$ 的数组 $a_1, a_2, \cdots, a_{n-1}$，你要找到一个长度为 $n$ 的数组 $x_1, x_2, \cdots, x_n$，满足 $x_i \times x_{i+1} \ge a_i$，并且 $\sum_{i=1}^{n} x_i$ 最小，$x_i$可以是实数。


题解：对于 $x_i$ 来说，要么有 $x_i \times x_{i - 1} = a_{i - 1}$，要么有 $x_i \times x_{i + 1} = a_{i}$，否则肯定可以减小 $x_i$.


如果 $i..j$ 这一段的等号全部成立的话，那么对应的函数是个对勾函数，最小值是唯一的。所以总的答案肯定是，整个序列被切成了若干段，每一段的等号全部成立，~~两段之间的那个 $x_i$ 取两个段最值的较大值~~。如果 $i..j$ 和 $j+1..k$ 之间的全部取到等号，那么就是对 $x_{j}$ 和 $x_{j + 1}$ 的值有个不等式。这样可以得到一个 $O(n^3)$ 的暴力 dp(i, j)，表示最后一段取等号的是 [i..j] 这一段。


优化的话，本来 dp(i, j) 可以更新到 dp(j, k) 的，按照 $j$ 从小到大做，在 j 的时候，把所有 (i, j) 确定的右端点，和 (j + 1, k) 确定的左端点拉出来排个序，就可以知道能够更新每个 $(j + 1, k)$ 的最小值是多少，这样就是 $O(n^2 \log n)$ 的。


## Problem J. Just a Math Problem


题意: 令$f(k)$是$k$本质不同质因子的数目, 令$g(k)=2^{f(k)}$, 求$\sum\limits_{i=1}^{n}{g(i)}$.


题解：$g(k)$ 可以看做是$(p , q)$ 的对数满足 $\gcd(p , q) = 1$ 且 $p \cdot q = k$。所以问题就可以变为求 $(p , q)$ 的对数满足 $\gcd(p , q) = 1, p \cdot q \le n$。不妨算 $p \le q$ 的情况，枚举 $p$，则只需用容斥原理即可算出 $q$ 的数量。复杂度为 $O(\sqrt{n} \log n)$


## Problem K. Kingdom of Obsession
题意：$n$ 个人编号为 $[s + 1 , s + n]$，有 $n$ 个座位编号为 $[1 , n]$，编号为 $i$ 的人只能坐到编号为它的约数的座位，问每个人是否都有位置坐。


题解：由于质数只能坐到 1 或者它本身的位置上，所以如果 $[n + 1 , n + s]$ 区间内如果有多于一个质数时肯定无解，有解时$s$ 一定不会很大。可以证明 $[s+1 , n]$这一段数肯定坐到自己编号的位置上要更好。所以对于剩下的 $s$ 个位置只需要暴力匹配一下即可。


[ftiasch wrote on 2016-10-29T09:04:12]

---

D 题还有一种能过的方法是，枚举每个 1~9 每个数字的个数（总和不超过 10），然后判断 y=f(y,K)-x 是否满足。

[hiaatcnd wrote on 2016-10-29T09:37:06]

---

@hiaatcnd#4697 嗯 稍微补充一下 因为$y$的数位不会超过10位，所以$f(y, K)$的值最多只有$C_20^10$种，这个数字是$1.8*10^5$，所以暴力枚举所有$f(y, K)$的值，然后就可以得到$y$，check一下$y$就好。

[mstczuo wrote on 2016-10-30T01:37:00]

---

http://izihan.cf/index.php/archives/115
部分题目题解及实现代码，仅供互相交流

[Vec wrote on 2016-10-30T03:20:45]

---

啊，突然发现挖的坑还没填。。

[Ruins wrote on 2016-10-30T05:55:28]

---

出题人的题解: http://ruinshe.moe/2016/10/30/ccpc2016-hangzhou-solutions/
包含E题的固定复杂度做法及I题的n^2 做法

[elfness wrote on 2016-10-30T06:42:53]

---

@elfness#4701 
不是特别理解I题n^2 的做法，大神可不可以解释一下？

[Skydog wrote on 2017-02-05T09:52:59]

---

