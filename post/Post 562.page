# HDU 5127 Yong Zheng's Death

2014广州现场赛C题，一道字符串的题目。 目前网上找不到题解。所以想在这里问下各位dalao们的解法。
题目链接：http://acm.hdu.edu.cn/showproblem.php?pid=5129


[kirito wrote on 2016-09-22T01:30:01]

---

在坟场里扒了扒：

>C. Yong Zheng's Death [jsy]
把所有的串建个AC自动机，设f[i][j]为abc形式的串的个数，ab是某个前缀，bc是另一个前缀。其中a的长度尽量长，然后是b的长度尽量长。然后按照 j 从大到小的顺序来做dp就好了。

[sd_invol wrote on 2016-09-22T02:33:22]

---

一个串会被算多次，就是说这个串存在多种划分使得前后都是一个前缀，设法把后一部分不是最短的那些划分全部减掉就不重不漏了。把所有串建一个$AC$自动机，那么划分总数是$(tot-1)^2$，这里$tot$表示总点数，现在记一个串为$A+B$，考虑从短到长枚举$B$，找出$B$的后缀中最长的并且是一个前缀的字符串$B_{suf}$，实际上就是从$B$对应状态向上跳一下$fail$，如果跳到$root$说明$B_{suf}$为空，那么这个是后一部分最短的划分，不用减掉，否则记$B=B_{pre}+B_{suf}$，如果$A+B_{pre}$也是一个前缀，那么$A+B$不是后一部分最短的划分，需要减掉，从$B$沿着$Trie$向上跳$len(B_{suf})$可以到$B_{pre}$，只需求出包含$B_{pre}$作为后缀的前缀个数，这相当于计算有多少个状态向上跳$fail$可以到$B_{pre}$，实际就是$fail$树上以$B_{pre}$为根的子树大小，在$fail$树上$dp$一下即可，总的复杂度是$O(n|\Sigma|)$

[quailty wrote on 2016-09-22T16:54:05]

---

@quailty#4382 ……在计算$A+B_{pre}$的个数时要求$A$不为空，因此要把$B_{pre}$本身减掉，以及最后复杂度应该是$O(tot|\Sigma|)$

[quailty wrote on 2016-09-22T17:37:02]

---

@quailty#4382 %%%

[TenderRun wrote on 2016-10-09T13:26:26]

---

