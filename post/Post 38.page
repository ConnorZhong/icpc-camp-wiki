# KTU Programming Camp (Day 2) J The craziness of Juvel

给出$n$个单词, 每个长度不超过100, 并且建成trie之后节点个数不超过100. 然后给出另一个字符串$s$, 以及$m$个操作, 每次可以修改$s$中的一个字符, 操作之后输出出现在$s$中的单词总数(每次匹配都算入答案). 

数据范围: $1 \le m, |s| \le 10^5, 1 \le n \le 100$

据说是在线段树上搞ac自动机, 但是要怎么搞呢?

[zimpha wrote on 2015-09-16T17:55:03]

---

一个粗暴的方法是：每个线段树节点记录 $100$ 个值，$go(v) :: V \to (V, \mathrm{Int})$ 表示从自动机的 $v$ 点出发，走完区间里的字符串，终点和匹配的次数。这似乎是很容易合并的……但是这样一次操作的复杂度是 $100 \log n$。

[ftiasch wrote on 2015-09-17T01:52:30]

---

@ftiasch#282 用线段树过掉了, 分块反而tle了

[zimpha wrote on 2015-09-17T08:26:04]

---

@zimpha#297 嗯我中午想起来分块复杂度算错了 = = 所以删掉了。

[ftiasch wrote on 2015-09-17T09:32:14]

---

