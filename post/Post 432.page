# SRM 660 Div 1 MEDIUM  Privateparty

题意就是说：有 $n$ 个人需要被按照某个顺序被邀请，每个人有一个仇人或者没有，如果仇人在这个人前面被邀请并且接受了邀请，那么这个人就会拒绝邀请。问随机拟定邀请顺序接受邀请的人数的期望。
看到有做法是考虑每个人的贡献，$G_i$ 表示长度为 $i$ 的仇恨关系链中最后一个人接受邀请的期望or概率
$G_i = (G_{i - 1} (i - 1) + G_{i - 2}) / i$
想问一下这个式子是怎么得到的>-<~

[keepit wrote on 2016-05-22T05:38:37]

---

同问, 顺便希望楼主可以Po一下更加详细的思路?

[headspin wrote on 2016-05-24T12:11:59]

---

虽然没想来, 不过可以给楼主提供另外一个思路, 得到的结果类似这个递推的展开
http://apps.topcoder.com/forums/?module=Thread&threadID=857292&start=0&mc=3#2129731

[headspin wrote on 2016-05-24T12:35:37]

---

N的范围多大，貌似可以树形dp

[suiyuan2009 wrote on 2016-06-27T14:56:58]

---

首先我们发现这是个树的结构
考虑每个节点的在多少个方案中贡献一个人头。
比如现在我们的节点是u，u的父亲是v，v的父亲是w，w的父亲是x，x的父亲是y，y的父亲是z。。。
然后我们第一种方案就是把v放在u的后面，酱紫u就肯定会被选到
....u......v......
考虑v在u的前面，那么我们就必须选w在v的前面，那么x就不能在w的前面
....w.....v...x..u....
考虑x在w前面的时候，我们就必须让y来管管x，酱紫z就不能在y的前面
....y...x...w...z...v...u...
那么我们就需要维护出长度为$i$的仇恨链，最后一个人被选的仇恨链排列的方案数$dp_i$，这里最后一个人就是u
显然，我们只需要讨论$i$是偶数的情况
这样$dp[i]=i-1$
在树上依次考虑每个节点，如果这个节点到根的距离是$L$，那么这个节点的贡献就是：
$\sum_{i=1}^{L/2} dp[2i]*C(n,2i)*(n-2i)!$
这个是可以预处理的

我是这么想的，根的情况可能需要讨论一下，唔。。不知道对不对，仅供参考


[HarryGuo2012 wrote on 2016-09-07T08:16:26]

---

