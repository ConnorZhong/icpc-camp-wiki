# Changchun 2015 B Count $a \times b$

$f(n)$ 定义为 $i \cdot j\ \mathrm{mod}\ n \neq 0$ 的数对 $(i, j)$ 的个数 $0 \leq i, j < n$，$g(n) = \sum_{d | n} f(d)$。

给出 $n$ $(n \leq 10^9)$，求 $g(n)$。

[QAQ wrote on 2015-10-19T10:21:40]

---

怎么捉QAQ

[QAQ wrote on 2015-10-19T10:22:09]

---

$f(n) = n\^2 - \sum_{d | n} d \cdot \phi\left(\frac{n}{d}\right)$

所以 $g(n) = \sum\_{m | n}\left(m\^2 - \sum\_{d | m} d \cdot \phi\left(\frac{m}{d}\right)\right)$

后面一部分换一下求和顺序就是 $\sum\_{d | n} d \sum\_{\frac{m}{d} | \frac{n}{d}} \phi\left(\frac{m}{d}\right)$。

然后大家大概都知道 $\sum\_{d | n} \phi(d) = n$，所以上面这个也就是 $\sum\_{d | n} d \cdot \frac{n}{d} = n \tau(n)$。

……肯定做麻烦了= =有啥一眼看出来的办法吗？

[ftiasch wrote on 2015-10-19T11:47:38]

---

@Varona#1970 前面部分暴力根号分解计算，后面部分是积性函数，根号分解质因数，然后分别暴力算，再把每个质因数答案乘回来，感觉应该可以

[mayf3 wrote on 2015-10-19T12:24:27]

---

@mayf3#1973 我认真看，我已经算出来了……我只是绕了一大圈得到了一个形式简单的结果，感觉应该有什么简单的解释。

[ftiasch wrote on 2015-10-19T12:32:36]

---

@Varona#1975 哇塞。。刚自己在想，又是看了前两行就没看了。。结论好优美，确实好像应该要有更直观的解释

[mayf3 wrote on 2015-10-19T12:40:09]

---

@Varona#1970 QAQ好优美的结论，万分感谢叉姐

[QAQ wrote on 2015-10-19T12:50:24]

---

@sorry_QAQ#1977 我深刻怀疑你不知道第一行是怎么来的……

[ftiasch wrote on 2015-10-19T13:04:57]

---

@Varona#1979 莫名戳中笑点哈哈

[mayf3 wrote on 2015-10-19T13:07:43]

---

@Varona#1979 QAQ确实不知道，感觉这样的题（反演或者积性函数之类的题）就是完全不知道怎么下手，有什么提高写这种题的能力呢（是多做题还是去补一下理论基础呢
感觉窝现在对反演这类题的理解还是很浅薄，只是记了一个公式并只会做一些很浅显的题QAQ求叉姐带

[QAQ wrote on 2015-10-19T13:09:41]

---

@sorry_QAQ#1981 

（我第一行算了一会儿 = = 嫌说明太麻烦了就直接写上去了）还是说明一下吧。

你想，既然 $ij$ 是 $n$ 的倍数，那么肯定是 $n$ 被分别分到了 $i, j$ 中。那么我们假设 $i = a x, j = b y$，其中 $ab = n$。相当于枚举 $n$ 是怎么被分解开的。但是这样的话，这种分解并不唯一，比如说 $4 = 1 \times 4 = 2 \times 2$。所以我们规定，在多种分解中，取 $a$ 最大的。这个东西换一种说法，就是 $\gcd(x, b) = 1$。于是我们就是要算
$$\sum\_{a | n} \sum\_{1 \leq x \leq \frac{n}{a}} [\gcd(x, b) = 1] \frac{n}{b}$$ 这个式子，其中 $b = \frac{n}{a}$。

另：我所有的反演题几乎都是手做的……我甚至连 $f \* 1 \leftrightarrow g \* \mu$ 都不太知道就能做。

[ftiasch wrote on 2015-10-19T13:26:47]

---

@sorry_QAQ#1981 推荐个数论十题。。

[mayf3 wrote on 2015-10-19T13:28:02]

---

@mayf3#1984

知道惹，万分感谢

[QAQ wrote on 2015-10-19T13:34:54]

---

@sorry_QAQ#1986 

这个东西没事推几遍熟悉就好了。。。

[yangyue wrote on 2015-10-19T15:43:31]

---

@Varona#1970  叉姐 那步交换求和次序 好美妙。！！！

[q63534597 wrote on 2015-10-20T02:36:01]

---

@q63534597#1989 感觉只是你见得少。。。大部分题都是这样子的

[ftiasch wrote on 2015-10-20T05:00:24]

---

发一个[我的方法](http://blog.csdn.net/skywalkert/article/details/49276505)，现场这么推感觉非常容易，然而QAQ。。。

[skywalkert wrote on 2015-10-20T06:04:13]

---

@skywalkert#2012 已关注√

[QAQ wrote on 2015-10-20T14:37:04]

---

@skywalkert#2012  十分感谢！

[QAQ wrote on 2015-10-20T14:48:09]

---

@skywalkert#2012 同意你的做法，就是正难则反，然后求两个积性函数。现场算 $h(p\^a)$ 不是很好算，要用几个欧拉函数叠加简化，我用了 $O(\sqrt(n) \log\^2 n)$ 复杂度也得到了类似结论，大赞！

[aclsh wrote on 2015-10-20T16:23:13]

---

@Varona#1983 我也不明白！这个第一行才是我的梗！💊

[yuzhou627 wrote on 2015-10-21T15:48:45]

---

设h(i)=i^2 - f(i)
打个表，然后肉眼可以看出
h(素数) = 2×素数-1
h(素数的i次幂) = h(素数的i-1次幂)×素数 + (素数-1)×素数的i-1次幂
h(除了前两种数)=h(它的第一个质因数的i1次幂)×h(它的第2个质因数的i2次幂)×....
就这样。。。。感觉这才是我等菜鸡的正确做法。。

[ZJiaQ wrote on 2015-11-01T07:12:59]

---

@skywalkert#2012 赞一个

[pis wrote on 2015-11-02T02:57:49]

---

可以分别讨论一下i,j同n的gcd，然后去掉gcd(i,n) * gcd(j,n) % n == 0的，还需要将所有d|n的phi(d)求出来。感觉这个方法不优雅，但是不用动脑子。（希望我没有看错题）

[litaoye wrote on 2015-11-02T05:28:38]

---

@ZJiaQ#2347 h(素数的i-1次幂)×素数 + (素数-1)×素数的i-1次幂
肉眼可以看出。。。

[whai362 wrote on 2015-11-02T05:48:38]

---

@pis#2364 id有点绿。。

[ZJiaQ wrote on 2015-11-02T08:04:26]

---

@whai362#2370 一下子是有点难看出，但是把那两种看出来这种单列出来试试就好了

[ZJiaQ wrote on 2015-11-02T08:04:53]

---

@Varona#1970   叉姐～我有稍微直观的解法……将a按n的约数进行分类，若a只含有n的因子d，则a的取法有phi(n/d),此时b有d种取法～叉姐这样对不？

[12170246 wrote on 2015-11-02T08:50:23]

---

有个打印错误
n×sigma(n)应为n×tau(n)
在数论中，一般用sigma(n)表示n的约数总和（sigma{d|n}(d)），而用tau(n)表示n的约数个数（sigma{d|n}(1)）

[world2 wrote on 2015-11-10T15:12:19]

---

@world2#2518 多谢指正！

[ftiasch wrote on 2015-11-11T03:16:22]

---

