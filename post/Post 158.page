# 2014 西安网络赛 H Number Sequence

给序列 $a_0, a_1, a_2, \dots, a_n$ 是 $0, 1, 2, \dots, n$ 的一个排列，再找出一个 $0, 1, 2, \dots, n$ 的排列 $b_0, b_1, \dots, b_n$ ，使得 $a_0 \oplus b_0 + a_1 \oplus b_1 + \dots + a_n \oplus b_n$ 对应项的异或值加起来最大，贪心地使最大的数异或值最大，$i$ 从 $n$开始减到 $0$，$b_i$ 定义成 $i$ 这个数异或的值，在 $i$ 最高位 $1$ 开始全部取反，得到比 $i$ 小的 $b_i$，这两个贪一下凑对，$b_{b_i}=i$，已经配对了就跳过，为什么最后异或和的最大值一定是 $n(n+1)$ ?
就是一些 ${11...11}\_2$ 的数，最高位不超过 $n$ 的最高位，加起来是 $n(n+1)$?

[题目链接](http://acm.hdu.edu.cn/showproblem.php?pid=5014)

[younis wrote on 2015-10-07T09:49:11]

---

一时没找到特别巧妙的办法……但是直接算技术上没有很大困难吧。

[ftiasch wrote on 2015-10-07T10:45:04]

---

@Varona#1565 感谢叉姐m(_ _)m

[younis wrote on 2015-10-07T11:01:51]

---

答案是$n(n+1)$还是不难证明的。
我们知道$x\oplus y\le x+y$，因此$n(n+1)$是答案的一个上界。为了说明这个上界是紧的，我们需要证明存在一个排列使得对应元素加起来的时候都没有发生进位。构造一个二分图，$X$集和$Y$集的元素都是$0,1,\ldots,n$。从$X$集的每个元素$x$向$Y$中那些$x$为$1$的位上都为$0$的数连边，我们希望这个图有完备匹配。用Hall定理，只需验证对于$X$的任意子集$S$，$Y$中与$S$相连的顶点个数不少于$|S|$。写开来就是验证$n$以内$\bigwedge_{x \in S} x$为$1$的位上都为$0$的数不少于$|S|$。

对于充分大的$n$，设它一共有$k+1$个二进制位，对于$|S|=m$，$\bigwedge_{x \in S} x$至多有$k+2-m$个位为$1$，因此去掉最高位的后$k$位也至多有$k+2-m$个位为$1$，让最高位为$0$，右$k$位中剩下$m-2$位随意变化，显然得到的数都不超过$n$。因此可以看到当$m \geq 4$时$Y$中至少有$2^ {m-2}$个点与$S$相连。这样就只要验证$m<4$的一些琐碎情况就可以了（最麻烦的是$m=3$且$n$特别小的情形，不过也是非常平凡的）

[fotile96 wrote on 2015-10-09T02:03:07]

---

@fotile96#1622 文盲跪谢主席m(_ _)m

[younis wrote on 2015-10-09T04:55:29]

---

@younis#1634 。。然而用证明那个贪心方法能结束要再方便一点。总之知道$x\oplus y\le x+y$当且仅当加法不进位就好啦

[fotile96 wrote on 2015-10-09T05:10:53]

---

