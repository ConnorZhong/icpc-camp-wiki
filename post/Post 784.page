# HDU 3507 加强后，是否还有高效算法？

http://acm.hdu.edu.cn/showproblem.php?pid=3507
该题原题题意为：给出 $n$ 个数，要求按顺序全部取出，每次取出一段，这一次所花费的费用为取出一段数的和的平方加$m$，问最小费用是多少？
现在：增加一个条件，每个区间长度不能超过 $limit$，$limit$ 为输入的一个正整数，其余数据规模不变，请问有什么高效的算法？


[14rj134 wrote on 2018-02-08T06:05:10]

---

暴力数据结构流的做法是 $O(n \log n)$ 的……

从左到右 dp，就是要维护住 $[i - \mathrm{limit}, i]$ 区间内的凸包。用持久化队列的技巧可以变成只插入的，所以平衡树维护就行了。

[ftiasch wrote on 2018-02-08T08:55:01]

---

@ftiasch#5586 嗯嗯，谢啦~

[14rj134 wrote on 2018-02-09T06:23:00]

---

@ftiasch#5586 就是动态维护凸包是吗？哎，学艺不精。。

[14rj134 wrote on 2018-02-09T06:48:38]

---

听说有个隐藏条件是元素非负？

一个易于实现的做法是对序列分治，假设已经求出$dp[l,m]$，要更新$dp[m+1,r]$，需要对每个$i \in [m+1,r]$求出$[\max(l,i-limit),m]$内的凸壳然后在上面二分/三分，从大到小枚举$i$就能增量构造所需的凸壳，复杂度是$O(n \log^2{n})$，常数应该比较小吧 ……

[quailty wrote on 2018-03-25T17:13:41]

---

