# 树上的回文

罗马种了一棵树，树上有n个点。每个点有一个小写英文字母。1号点是树的根，剩下的n-1个点都有一个父亲。点和父亲之间通过一个边相连。第i个点的父亲是pi,且pi<i。
一个点的深度是从根到当前点的路径上经过的点数。根的深度是1。
U在v的子树中，当且仅当u往根方向走可以到达v。特别的，v也是在v的子树中。
罗马给你m个查询，第i个查询包含两个整数vi,hi。现在收集在vi子树中且深度是hi的结点。判断一下把这些结点重新排列是否能组成一个回文。
罗马种了一棵树，树上有n个点。每个点有一个小写英文字母。1号点是树的根，剩下的n-1个点都有一个父亲。点和父亲之间通过一个边相连。第i个点的父亲是pi,且pi<i。
一个点的深度是从根到当前点的路径上经过的点数。根的深度是1。
U在v的子树中，当且仅当u往根方向走可以到达v。特别的，v也是在v的子树中。
罗马给你m个查询，第i个查询包含两个整数vi,hi。现在收集在vi子树中且深度是hi的结点。判断一下把这些结点重新排列是否能组成一个回文。
样例解释：
一个字符串s是回文，当且仅当他正着读和反着读是一样的。空串也是回文。
第一查询中，点1包含z，可以构成回文。
第二个查询中点5和6包含c，d，这个不能组成回文。
第三个查询中，没有点是深度4的，组成一个空串。
第四个查询中，也是构成了一个空串。
第五个查询中，2,3,4符合查询条件，包含字母a,c,c。可以构成cac。
Input
单组测试数据。
第一行包含两个n, m (1≤n,m≤500000)，表示树的结点数目和查询数目。
第二行有n-1个数字 p2,p3,...,pn ，表示每一个点的父亲。(1≤pi<i).
接下来一行有n个小写字母，第i个表示第i个点上面的字母。
接下来m行每一行有一个查询，包含vi, hi (1≤vi,hi≤n)，表示点编号和深度。
Output
对于每一个查询，如果能够组成回文，输出Yes,否则输出No。
Input示例
6 5
1 1 1 3 3
zacccd
1 1
3 3
4 1
6 1
1 2
Output示例
Yes
No
Yes
Yes
Yes

请问这道题怎么做呀？


[Fancy wrote on 2016-11-12T10:58:16]

---

dfs，对于每个子树，预处理出 mask[]，其中 mask[d] 是一个 26 位的二进制数，表示深度为 $d$ 的每种字符出现次数的奇偶性，启发式合并 mask[].

[ftiasch wrote on 2016-11-12T11:03:36]

---

谢谢叉姐！

[Fancy wrote on 2016-11-12T11:58:53]

---

@ftiasch#4770 谢谢叉姐！

[Fancy wrote on 2016-11-12T11:59:33]

---

[题目](http://codeforces.com/contest/570/problem/D)和[题解](http://codeforces.com/blog/entry/19770)

[quailty wrote on 2016-11-12T16:10:33]

---

询问离线，同一深度的询问一起处理，线段树维护dfs序就行了

[samzhang wrote on 2016-11-18T09:31:28]

---

