# NEERC 2014 H Hidden Maze

[Link](http://codeforces.com/gym/100553)

给定一棵随机生成的树，边上有权，求所有奇数长度的路径上中位数的总和。

$n \leq 30000$


[sd_invol wrote on 2015-10-06T08:03:10]

---

我想象了一个这样的做法……

我们考虑 $e = (a, b)$ 是中位数的边，如果我们把比 $e$ 小的标为 $-1$，比 $e$ 大的标为 $+1$，那么等价于经过 $e$ 有多少路径的权值和为 $0$。为此，我们如果能够快速处理出一个 $\\mathrm{list}(a)$  表示 $a$ 出发的，总和为 $x$ 的路径的数量，那么每次只要暴力合并一下 $\\mathrm{list}(a)$ 和 $\\mathrm{list}(b)$ 就可以了。动动小脑的话，我猜 $\mathrm{list}(v)$ 其实是 $O(\log n)$ 级别的。

剩下的问题是怎么快速地把这个东西求出来啦。如果我们从小到大地枚举 $e$ 的话，其实就是有时候 $+1$ 会变成 $-1$ 嘛。但是说白了就是区间加减，算区间里面某个值出现了多少次。

如果咱的理 (xiao) 论 (nao) 信得过，应该就是 $O(n \log\^2 n)$ 的算法。

[ftiasch wrote on 2015-10-06T08:51:15]

---

丢一发官方简要题解: [Link](http://www.slideshare.net/elizarov/review-42458841). 据说复杂度是$O(n \sqrt n)$

[zimpha wrote on 2015-10-06T09:12:05]

---

我前面的想象应该是错的。我写了个程序试了一下，差不多是 $O(\sqrt{n})$ 的阶。

[ftiasch wrote on 2015-10-06T11:18:24]

---

@Varona#1514 对的，这个随机有毒。。以前训练的时候就写了这个做法。。还纳闷为啥随机树直径这么长233

[flydutchman wrote on 2015-10-06T12:05:51]

---

@Flydutchman#1516 原来这个随机和想象中的不一样 = =|||

[sd_invol wrote on 2015-10-06T12:09:48]

---

@Flydutchman#1516 你会计算这个期望吗？

我想了想，还不会算。

[ftiasch wrote on 2015-10-06T12:47:10]

---

@zimpha#1513 @Sd_Invol#1517 我仔细（？）研究了毛子的题解，我发现我的理 (b) 论 (b) 除了复杂度不太对之外，没什么很大的问题啊。

当然毛子算那个 $\\mathrm{list}(v)$ 的方法跟我不太一样，所以少个 $O(\log n)$ 的因子。

[ftiasch wrote on 2015-10-06T13:54:16]

---

