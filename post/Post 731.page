# 2017 西安网络赛 J Easy Problem

进行Q次操作，操作分三种：
1 n x1 x2 .. xn 添加一行长度为n的数组x[1..n]
2 x l1 r1 y x2 y2 复制第x行[l1,r1]段和y行[l2,r2]段，合并成一个新的串放到下一行中
3 x k 输出第x行的第k大（从小到大排列第k个）连续子段和
数据范围：Q<=10^5 ，每组数据n的和与k的和都不超过10^6 ，每行串的长度不超过10^6 ，所有输入均为非负整数
PS：据说这题可以用可持久化Treap做，不过我有以下几个地方不太懂。首先，第二个操作直接复制串会产生新的内存导致空间不够，是否有类似标记的方法处理；其次，第三个操作首先要找到该行的单个数字前min(n,k)大的元素，这个在Treap上如何操作，特别是对于含有标记指针的行 请大佬们指点一下～（最好提供一份处理这种区间复制操作的板子参考一下orz

[aclsh wrote on 2017-09-18T11:57:54]

---

求解答。。讲一下思路就好

[aclsh wrote on 2017-09-19T23:55:51]

---

操作2可持久化treap每次只会多logN个节点。

[Mcginn wrote on 2017-09-20T12:02:16]

---

@Mcginn#5372 操作2如何可持久化处理保证只遍历logn个节点呢

[aclsh wrote on 2017-09-20T16:08:48]

---

@aclsh#5373 树高期望log，提取区间只需要做两次split操作，合并两个区间就是一次merge操作，每次只有log个节点的信息发生变化，可持久化意义下当然就是新建log个节点啊？

[quailty wrote on 2017-09-20T18:19:05]

---

