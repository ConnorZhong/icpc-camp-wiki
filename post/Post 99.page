#  Codeforces Round #320 F LCS Again

题意：给出字母表的大小 $m$ 。再给一个长 $n$ ($n \leq 100000$) 的字符串，问有多少跟这个字符串的 lcs 长是 $(n - 1)$ 的串。
听说有 dp 做法和 yy 做法，然而我哪个都不会……有没有可以指点一下的。。？

[gu_castle wrote on 2015-09-29T09:27:26]

---

无责任搬运
xxx 11:12:59
枚举i, j 代表前i个字符以及后j个字符和第一个串一一匹配
然后剩下部分一定是
a1 a2 a3 a4
k  a1 a2 a3
或者
a1 a2 a3 a4
a2 a3 a4 k
这两种贡献都容易分别统计
xxx  11:13:17
还有一部分是重复的
即  k1 a1 a2 a3 = a2 a3 a4 k2 =〉a1 = a3  a2 = a4 且 a1 != a2  a3 != a4


(i,j)这个子串对答案有贡献，仅当 该串的奇数位都是同一字符
偶数位是同一字符，前两个字符不同，后两个字符不同。

[zjyjer wrote on 2015-09-29T09:33:09]

---

THX

[gu_castle wrote on 2015-09-29T09:41:57]

---

请问这题用dp是怎么做的 状态转移 有点蒙了

[opas wrote on 2015-09-30T02:25:05]

---

@opas#1018 这题 dp 实际上是个 dp 套 dp，确实颇有一点复杂 ……

[ftiasch wrote on 2015-09-30T02:51:44]

---

考虑直接做lcs的dp状态：dp\[i][j]=S的前i个字符与j的前j个字符的LCS。
那么dp\[i][j]=max(dp\[i][j-1],dp\[i-1][j]),如果S\[i]=S[j]那么dp\[i][j]=max(dp\[i][j],dp[i-1][j-1]+1)。
然后我们发现如果dp\[i][j]\<min(i,j)-1的话，那么这个状态就是无用的——因为这个状态不可能转移到dp\[n][n]=n-1的状态。
而且显然dp\[i][i-2]这个状态不管等于多少，肯定也转移不到dp[n][n]=n-1这个状态。。

所以对于一个i，我们关心的状态是dp\[i]\[i],dp\[i-1]\[i],dp\[i]\[i-1],dp\[i-1]\[i-1]。这四个状态，而且这四个状态的取值只能为：(i或i-1),(i-1或i-2),(i-1或i-2),(i-1或i-2)。(共2^4种情况,(其实有冗余，但是别管那么多细节啦))

我们不妨dp套dp，记F\[i][State]=有多少个长度为i的T串，使dp\[i]\[i],dp\[i-1]\[i],dp\[i]\[i-1],dp\[i-1]\[i-1]成16种情况的State情况。

然后注意到我们可以枚举下一个字符是啥，由State转移到另一个State(自己推推看?)
然后就做好辣。

第一次写的话要注意一下边界情况。。还不懂的话，可以看陈老师的2015冬令营讲稿学习姿势。(或者等待置顶里把陈老师的ppt放出来？233)

[mikantsumiki wrote on 2015-09-30T03:37:06]

---

@MikanTsumiki#1023 你这个做得太一般了……对于这个题来说没有这么麻烦。

因为实际上就是在 $y = x$ 这条斜线上走，在中间某一步走到 $y = x + 1$ 或者 $y = x - 1$ 这条线，再后来又拐回来。所以只要压 $2^3$ 表示现在可能在那条线上就行了。

（置顶帖已更新

[ftiasch wrote on 2015-09-30T04:43:49]

---

