# 2016 东北四省赛 题解

以下是 ICPCCamp 团队所写的非官方题解，感谢大家的帮助和支持。欢迎大家回帖交流。

感谢 @NPC @ftiasch @rowdark  @Sd_Invol 在过程中的帮助。

---

## 1001.Minimum’s Revenge

题意：一个 $n$ 个点的带权无向完全图，两个点间的边权是这两个点标号的 LCM，求该图的最小生成树。

题解：考虑 Kruscal 的过程，每个点相邻的所有边中到 1 的边权是最小的，所以最小生成树就是从 1 号点连向其他所有点，代价为 $\frac{n(n+1)}{2} - 1$。

## 1002.Prediction

题意：$n$ 个点 $m$ 条边的图，另有一颗 $m$ 个点的树，$q$ 个询问，每个询问将 $k_i$ 个点以及这些点的祖先染黑，询问染黑的点在图中对应的边行程的连通块的数量。

$n \leq 500, m \leq 10^4, q \leq 50000$

题解：对于树上的点，预处理根到它形成的生成树上的边。每次询问就暴力把预处理好的生成树的边并一下，复杂度是 $O(n(m + \sum k_i))$.

## 1003.Mr. Frog’s Problem

题意：给 $A, B$，问有多少 $C, D$ 满足 $\frac{A}{B} + \frac{B}{A} \leq \frac{C}{D} + \frac{D}{C}$.

题解：只有 $\{A, B\} = \{C, D\}$ 这种情况。

## 1004.Coconuts

题意：一个 $R \times C$ 的棋盘，有 $n \le 200$ 个格子是黑的，其他都是白的，问所有白色格子构成的四联通块有多大。

题解：离散化后 BFS。

## 1005.Mr. Frog’s Game

题意：连连看，问当前局面有没有死。

题解：只用考虑拐 0 次和 2 次，0 次是存在相同数字相邻，2 次是看在同一个边界上有没有相同的数字。

## 1006.Auxiliary Set

题意：给定一棵树，每次询问一个集合，问所有不在这个集合的点两两 LCA (可以相同)的并集大小。

题解：实际上就是对于每个被删掉的点，check 一下是不是除了一个子树之外的点都被删掉了。那么对于每个被删掉的点的连通块，从最高点开始 dfs 就行。

## 1007.Birthday Gift

题意：平面上有 $N$ 个点，问用一条长度为 $l$ 的绳子最多能围住几个点。

题解：dp。枚举最低点 $l$，按照关于 $l$ 的极角序排序，设 $dp(x, c)$ 表示一个在 $x$，内部有 $c$ 个点的最短绳长，转移的时候枚举 $y$，要求 $xy$ 的极角序递增。

## 1008.Basic Data Structure

题意：维护一个栈，支持往栈里塞 0/1 ，弹栈顶，翻转栈，询问从栈底到栈顶按顺序 NAND 的值。

题解：只要知道最后的 $0$ 后面 $1$ 的个数的奇偶性就行。可以用链表把所有 $0$ 的位置存下来。

## 1009.GCD

题意：维护一个序列，每次修改一个数，询问所有区间 gcd 的的种数。

题解：考虑修改时哪些区间的$\gcd$会发生变化。显然，只有那些满足$l \leq x \leq r$的区间的$ \gcd$才会发生变化，又我们有
$\gcd(a_l, \ldots, a_r) = \gcd(\gcd(a_l, \ldots, a_x), \gcd(a_x, \ldots, a_r))$
于是我们可以考虑计算$\gcd(a_x, \ldots, a_r)$，当$r$发生变化时，我们知道不同的$\gcd$个数只有$O(\log C)$个。然后暴力合并左右的gcd即可。
观察到一件事情是，每次$\gcd$发生变化，本质上是质因数的幂指数发生了变化。于是对于每个质数的每个指数维护一个 set ，之后等价于查之后第一个不是其倍数的位置，这样我们就可以在$O(\log^2 C)$的时间内求出所有的$\gcd(a_x, \ldots, a_r)$。考察合并，本质上也是幂指数上的变化，于是利用单调性，合并也可以做到$O(\log^2 C)$，于是这个题整体就做到了每次修改$O(\log^2 C)$了。

## 1010.Mission Possible

题意：一个人有三种属性:$H, V , R$。表示每秒这个人的生命值为 $H$, 每秒可以跑 $V$ 米，每秒生命恢复 $R$。现在他要跑够 $D$ 米，且每秒结束后会先受到 $A$ 伤害再恢复 $R$ 点生命。现在这个人初始三个能力都为 $0$，提高一点 $H , V , R$ 分别需要 $G_1 , G_2 , G_3$ 块钱，问这个人至少花费多少钱才能达到目标。

题解：设生命恢复次数为 $T$，显然有 $T = \lfloor \frac{D}{V} \rfloor$。所以$V$ 的取值只有 $O(\sqrt{D})$ 个。枚举 $V$ 后，只要满足 $H \ge A$ 且 $H + T \cdot R \geq \frac{AD}{V}$即可。相当于两个变量的整数规划，需要细节比较多的讨论。

## 1011.Backpack on Tree

题意：给一颗n个点的树，对于每颗子树，保证其儿子为根的子树的大小不超过其$\frac{2}{3}$。每个点上有一个物品，其体积不超过$5$，价值不超过$10^9$。一共有$Q$个询问，问在以点$s_i$为根的子树中，如果取的物品的体积和恰好为$t_i$时，价值总和最大能是多少。

题解：首先，要观察到一件事情，如果若干个$1,2,3,4,5$的和大等于$120$时，一定有一个子集和为$60$。这意味着，对于同一棵子树，$dp_i,dp_{60+i},dp_{120+i},\ldots$形成一个凸函数。于是合并两颗子树时，可以将各拆成$60$个凸函数，然后利用 minkowski 和合并凸函数，这样单次合并的运算量就为$60(l_1+l_2)$。然后考虑如何优化合并次数，一个显然的想法就是利用线段树的方式进行合并，但这样复杂度就变为$O(N\log^2 N)$。然后考虑最优的合并方式，显然是使用 huffman tree ，可以证明这样合并的复杂度为$O(N\log N)$，这是因为对于 huffman tree 上的节点，其父亲的父亲的大小至少为其两倍。于是，这样就可以$O(N\log N)$预处理出所有的答案。



[sd_invol wrote on 2016-10-06T09:01:50]

---

1009 GCD 
按题解前面的暴力思考，避开里面说的set维护，我们只要线段树就行，每个节点维护两端的gcd序列就行了。


[wtw wrote on 2016-10-06T16:19:50]

---

@wtw#4543 对，但是线段树，gcd 序列，求 gcd 共计 $O(\log n \log^2 C)$. 题解是少一个 $O(\log n)$ factor 的。

[ftiasch wrote on 2016-10-07T00:25:56]

---

