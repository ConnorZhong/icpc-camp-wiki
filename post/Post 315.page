# 2维平面带权点集范围内离线询问

诸君:

见帖好,
今年夏天的时候工作中遇到一个算法问题:
已知平面上有带权点N个, 对于每个点做一次询问, 总计N次询问:

    对于点P, 在所有距点P距离不超过R的点中, 其中是否存在至少K%的点其权值不大于点 P的权值.

离线处理所有结果后返回.

而后自己的处理方式是放弃使用欧式距离标准(sqrt( dx^2 + dy^2 )), 做成了切比雪夫距离(max(dx, dy))的近似解, 即把以点P为圆心划一个半径为R的圆改变为以点P为中心做一个边长为2R的正方形. 然后将这个近似解用到了项目之中.
PS: 该近似解用的是扫面线+主席树处理的, 复杂度O(n logn logn)

先希望请教各位神牛, 是否存在复杂度在O( n^2 )以下的算法可以解决该问题的欧式距离解.

祝: 武运昌隆
Masoshonen

[jki14 wrote on 2015-12-03T02:51:33]

---

@masoshonen#2944 
$k$-d 树套个什么东西（强行）就是 $O(n\^\frac{3}{2} \log n)$ 的吧。

[ftiasch wrote on 2015-12-03T03:29:32]

---

@Varona#2945 
先谢叉姐,
hmmm... 但是大概套个什么呢?
 因为可能出现点特别密集的情况:XD 如果是单独每次询问kd-tree搜索R范围内的所有点然后做统计效果很差(负责Vision部分的同事试过了).
叉姐的意思是在kd-tree上面做操作的时候使得每次询问不独立的方法么?

[jki14 wrote on 2015-12-03T05:42:49]

---

@masoshonen#2949 套个啥都行，什么线段树平衡树啥的。

[ftiasch wrote on 2015-12-03T12:05:46]

---

感觉可以这样，按权值从小到大依次加入每个点，然后用kd-tree查询距离当前插入的点不超过R的点的个数，这样子的时间复杂度是$O(N\sqrt{N})$。

[Claris wrote on 2015-12-03T15:06:48]

---

@Varona#2953 

hmm...
我先去悟一悟，鄙人悟性较低；
如有不懂，再来请教 TAT

[jki14 wrote on 2015-12-04T00:50:14]

---

@Claris#2954 

感谢帮忙,
但是kd-tree每次查询在点特别密集的时候甚至退化成O(n)的样子- -;
或者是我的理解没有到位额.
且最终还是需要得知距点P距离不大于R的总的点数的样子, 因为算法需求是判断是否超过某个百分比的数量

[jki14 wrote on 2015-12-04T01:52:35]

---

@Varona#2953 @Claris#2954 

更新一波可能可用于优化的条件, n大致是个10k级的数, 坐标x∈[0, 640], y∈[0, 480]且为整数.
另仍然无法参透叉姐所说的算法TAT
难道kd-tree可以依路劲(例如dfs序??)得出一个距离R以内点的增量变化?且每个点进出这个圈不超过sqrt(n)?


[jki14 wrote on 2015-12-04T03:01:56]

---

@masoshonen#2957 然而kd tree在随机数据下跑得很快啊

[YJMWOI wrote on 2015-12-06T14:03:04]

---

@YJMWOI#2988 

hmm..
然而数据是图片被SIFT-FAST后的点坐标，相当不随机 - -

[jki14 wrote on 2015-12-07T00:56:14]

---

