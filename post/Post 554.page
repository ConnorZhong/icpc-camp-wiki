# Codeforces Round #371 (Div. 1) C Sonya and Problem Wihtout a Legend

给定$1$个$N\le 3\times 10^3$的序列$A$，现在要找到一个严格递增的序列$B$，使得$\sum |A_i-B_i|$最小

题解说的是，先考虑令$A_i'=A_i-i$转化为非严格递增的版本，可以发现存在一个非严格递增的数列$B'$，且$B'$中的元素都来自$A'$，这个怎么证明呢

[TaoSama wrote on 2016-09-14T07:40:09]

---

[很久远的那个题的题解](http://codeforces.com/blog/entry/364?#comment-4943)

[quailty wrote on 2016-09-14T08:06:27]

---

如果考虑2个数A1,A2.不妨假设A1 > A2.现在要变成非递减的序列.那最少次数只会是A1-A2. 就可以看成把A1变成A2,或者把A2变成A1. 如果想要把A1变成X,A2也变成X.那结果不会比A1-A2这个答案更小.
辣么,对于n个数来说,推广脑补一下,就可以啦.


[wumpus wrote on 2016-09-14T12:09:43]

---

@quailty#4261 qqqqqqqqq太太太太太太太太太太太太太太太太强强强强强强强强强强强强了，爱你😘

[samzhang wrote on 2016-09-15T00:09:14]

---

- - 谢楼上诸位巨巨，窝是替samzhang问的QAQ，虽然窝自己也是半懂

[TaoSama wrote on 2016-09-15T13:14:31]

---

一个非主流做法(？
首先你要知道我们可以让fij表示第i个数结尾为j时候的最小代价.

这样转移呢，复杂度会很高，大概是O(NM)级别的？

然后值得注意的一点是我们可以注意到(1,fi1)，(2,fi2)...这些点画到平面上大概会是一个下凸壳..


然后我们可以整体转移一下..一次由当前凸壳算出下个凸壳.

注意到转移实际上就是shift一下左右两侧的凸壳拼起来，所以开两个堆就行了大概.

这样做复杂度大概是O(nlgn)的，并不需要什么结论和证明，总之只需要记住总体dp与观察出转移维持凸性就好……<del>写起来很短</del>


为什么会用这种方法？因为作为主席博客的忠实粉丝，学习过一波ctsc2009序列变换的做法..可惜post已被删除..(ctsc那题就是这题的加强版


[mikantsumiki wrote on 2016-09-16T03:30:12]

---

@MikanTsumiki#4282 感觉其实一切都很自然，不过类似的东西没有流行起来可能是适用的题目太少。这类东西好像强行造也不一定弄得出来

[fotile96 wrote on 2016-09-28T10:26:03]

---

