# 2017 Qingdao G Pythagoras, One More Time

求满足 $x^2 + y^2 =z^2 - 7$, $x \leq y \leq z \leq n$ 的 $(x,y,z)$ 三元组个数.

$n \leq 10^8$, $10000$ 组 case

[ephxyscj wrote on 2017-11-15T11:29:48]

---

https://www.cut-the-knot.org/pythagoras/PT_matrix.shtml

---

XG 天下一！


[ftiasch wrote on 2017-11-15T15:56:05]

---

@ephxyscj#5494 大胆猜测我们只要能枚举出所有合法的$(x, y, z)$就做完这题了。~~然后这玩意大概可以换元变成个椭圆曲线，大抵就是在椭圆曲线上找有理点的问题~~。如果你做过PE 223和224，那么会在Thread里面找到三个矩阵，具体怎么得到这三个矩阵里面也有解释
```
const int A[3][3] = {{-2, 1, 2}, {-1, 2, 2}, {-2, 2, 3}};
const int B[3][3] = {{1, -2, 2}, {2, -1, 2}, {2, -2, 3}};
const int C[3][3] = {{2, 1, 2}, {1, 2, 2}, {2, 2, 3}};
```

如果已知$u=(x,y,z)^T$是一个解，那么$Au,Bu,Cu$都是一个解。大抵只要找出最小的那些$(x, y,z)$就好了，这个你就随便设个$x,y,z$的bound，暴力枚举出所有可行的，然后把存在前驱的删掉，留下来的就是你要找的最小$(x,y,z)$（一般都称之为seed）。这个题有这么4对seed：$(1,1,3), (2,5,6), (3,3,5), (11,14,18)$.

从这4个seed出发做bfs或者dfs就好了，注意到$A$矩阵可能会生成一些$x > y$的三元组，这些是没有用的，记得删掉就好了。

[zimpha wrote on 2017-11-15T16:03:47]

---

@ftiasch#5495 @zimpha#5496 感谢大佬们！

[ephxyscj wrote on 2017-11-16T00:10:47]

---

抱歉挖坟><

最近刚好做PE 223和224，就想起去年这题。

这题提交在 https://nanti.jisuanke.com/t/18517  ，计蒜客给了14s和256MB内存。

我的做法是一次直接dfs统计$10^8$下所有满足要求的$z$然后做一下前缀和二分，但是MLE了。

我的解法本地跑完大概能做到极限数据3s左右，假设计蒜客时间两倍计6s，目前还剩下8s，是不是有什么时间换空间的优化办法？

[lxdlam wrote on 2018-08-27T15:01:11]

---

@lxdlam#5719 

自问自答，扫了一下发现每个满足要求的$z$的个数不超过$127$，用了一个char数组做统计然后两个int一个统计位置一个做前缀和，二分了一下就过了。

230M内存卡过去的，时间倒是才3.3s，不知道14s的意义所在……应该是有什么我不懂的优化……

[lxdlam wrote on 2018-08-27T15:50:35]

---

