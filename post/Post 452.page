# 计蒜之道 2016 第一场 青云的机房组网方案（困难）

有一棵10万级的树，每个节点有一个权值，权值也是10万级的，问所有两个权值互质的节点之间距离的和

困难版本的完全没有思路，求各路大神赐教

[burglar wrote on 2016-06-06T02:41:43]

---

题目链接http://nanti.jisuanke.com/t/11135

[burglar wrote on 2016-06-06T02:43:37]

---

假设所有节点都是互质的，那么O(n)可以求。然后减去各种不互质的情况，那么最多有约数个数棵树，这些树总的节点数量为n*d(max)，然后配合miu函数做容斥？（我猜的，毕竟没真做过这题）

[litaoye wrote on 2016-06-06T03:38:50]

---

我想问下那个约数个数棵树是怎么来的？ 是对1到10万每一个数字枚举约数， 然后对节点权值为这个约数的点建树，是这个意思么？

[burglar wrote on 2016-06-06T03:53:40]

---

@litaoye#3740 我想问下那个约数个数棵树是怎么来的？ 是对1到10万每一个数字枚举约数， 然后对节点权值为这个约数的点建树，是这个意思么？

[burglar wrote on 2016-06-06T03:54:02]

---

枚举 $d$，把 $d$ 的倍数找出来，建立对应的虚树，在虚树上 dp 算出两两的距离

[ftiasch wrote on 2016-06-06T04:34:14]

---

@Hayashimo#3744 虚...虚树...（/TДT)/

[fhy_tan wrote on 2016-06-06T08:07:50]

---

直接点分治就可以了。

[daizhenyang wrote on 2016-06-07T17:49:50]

---

好像是某次CC出过，当时点分会TLE，容斥能过

[fotile96 wrote on 2016-06-08T02:07:14]

---

点分治统计答案时候容斥

[daizhenyang wrote on 2016-06-08T06:36:44]

---

