# Changchun 2015 H  Partial Tree

给 $n$ 个点让你构造一棵树，使构造完毕后每个点的权值的总和最大。其中一个点权值等于 $f(d)$，$d$ 是该点度数，$f(d)$ 是输入中给出的。
个人觉得就是将总度数 $2n-2$ 划分成 $n$ 个范围为 $1\dots (n-1)$ 的数，$\mathrm{dp}\_{i,j}$ 表示将 $i$ 个数组成 $j$ 的最大权值和，然后 $\mathrm{dp}\_{i,j} = \max\\{ \mathrm{dp}_{i - 1, j - k} + f(k)\\}$ ，枚举可行的 $k$，答案是 $\mathrm{dp}\_{n, 2n - 2}$。但是复杂度是 $O(n\^3)$ 的，怎么优化求教。。。

[UUZ wrote on 2015-10-18T11:17:04]

---

为什么字体到后面变得奇怪了orz。。。

[UUZ wrote on 2015-10-18T11:18:39]

---

$f(d)$ 没有什么限制吗？

$n$ 是多少？

[ftiasch wrote on 2015-10-18T11:29:07]

---

@Varona#1910 $f(d) \leq 10000$，$n \leq 2015$。组数 $2015$ 不过 $n$ 大于 $100$ 的不超过 $10$ 组

[UUZ wrote on 2015-10-18T11:31:28]

---

@UUZ#1911 你先假设大家都是 $1$ 度点，那么就是要把其中某些点的度增大，增大部分的总和是 $n - 2$。

那么就设 $h(i, j)$ 表示增大到 $\leq i$ 的点已经考虑了，已经增大了 $j$。转移就是 $h(i, j) = \max\\{ h(i - 1, j), h(i, j - (i - 1)) + f(i) - f(1) \\}$.

这个方法的巧妙之处就在于，不需要知道具体增大了多少点，因为大家加起来只有 $(n - 2)$，是肯定不会超过 $n$ 个的。

[ftiasch wrote on 2015-10-18T12:01:19]

---

@Varona#1913 请问还有没有类似于这样类型DP的题目？

[woshi_sb wrote on 2015-10-18T12:10:17]

---

@woshi_sb#1914 不知道这个属于哪个类型= =

[ftiasch wrote on 2015-10-18T12:11:24]

---

@Varona#1915   我的意思是有没有类似于这样看起来直接DP得跪，但是换一种思路来可以巧妙得解决问题。  想来几道涨涨见识。。

[woshi_sb wrote on 2015-10-18T12:46:44]

---

@woshi_sb#1916 感觉还是挺多的 = = 不是很想找。

[ftiasch wrote on 2015-10-18T12:48:38]

---

@Varona#1917      叉姐，跪求1、2到解解馋啊~~~~~~ 

[woshi_sb wrote on 2015-10-18T13:03:00]

---

@woshi_sb#1918 比如说 [CF 183D T-shirt](http://codeforces.com/problemset/problem/183/D) 我个人还挺喜欢的……

[ftiasch wrote on 2015-10-18T13:15:50]

---

@Varona#1919    谢谢，叉姐啦~~~

[woshi_sb wrote on 2015-10-18T13:21:25]

---

@Varona#1913 get，学习了（其实是增大n-2，不是n-1，逃~

[UUZ wrote on 2015-10-18T13:23:39]

---

@UUZ#1921 已改……咱算术不好，别欺负咱。

[ftiasch wrote on 2015-10-18T13:29:13]

---

@Varona#1922 叉姐说笑了。。。orz

[UUZ wrote on 2015-10-18T13:31:39]

---

@woshi_sb#1914 
叉姐的解法感觉是**完全背包**

貌似比赛我是用另一种DP的方式过的

第一步和叉姐一样，也是先假设全部都是1度点，增大总和为n-2
把所有f(d)扣掉f(1)，DP结束后得到的结果再加上n*f(1) （不然DP时不好处理）

h(i)表示已经增大了i。
转移：**h(i)=max{f(i+1),h(j)+h(i-j)}**   （0<j<=i/2）

这方法空间复杂度是O(n)，不过并没什么卵用

[bnmjtz wrote on 2015-10-22T08:53:50]

---

相当于：背包容量为n-2，“增加度为i的点”看作物品，那就是完全背包了（因为物品个数不会超过背包容量）。

[xcw0754 wrote on 2015-10-23T05:20:50]

---

@Varona#1913 我比赛的时候吧这个题完全的分析成了一个背包的问题。。。，V=树节点的度数和2*(n-1),然后经过分析得到每种度数的节点最多有多少个，然后做了一个背包，结果血崩。叉姐能帮忙分析下这个思路的错误吗？

[bigship wrote on 2015-10-23T13:10:48]

---

@bigship#2126 这思路没有错误啊……只是不足以解决这个问题而已。

[ftiasch wrote on 2015-10-23T14:18:24]

---

为什么不足以解决这个问题，请叉姐指教

[life4711 wrote on 2015-10-27T12:25:48]

---

@life4711#2227 你复杂度不对怪我咯…

[ftiasch wrote on 2015-10-27T12:27:46]

---

@Varona#2228 利用二进制优化一下呢，现场赛返回的是wa，

[life4711 wrote on 2015-10-27T12:31:02]

---

@life4711#2229 二进制没法保证一定取了那么多个啊……

[ftiasch wrote on 2015-10-27T12:36:53]

---

@bigship#2126 你的复杂度是 $O(n ^ 3)$ 的，可以用倍增优化到$O(n ^ 2 log n)$，再加一些常数优化就可以过了。

[mstczuo wrote on 2015-11-02T16:51:02]

---

