# 曼哈顿最小化

n ( n<10^5 ) 个整数点, $(X_i, Y_i)$,   -10^4 < $X_i,Y_i$ < 10^4 .
Minimize $f(X, Y)$ over 整数 $X,Y$ :

$f(X, Y) = \max\limits_{1 \leq i \leq n} { |X_i - X| + |Y_i - Y| + | (X+Y) - (X_i + Y_i) |}$
                 

似乎三分法搜索 X,Y 也许可以解决？

[baodog wrote on 2015-11-28T07:22:01]

---

我有个想法：分开考虑每个点，你会发现$f(X,Y)$是$n$个二维单峰函数的Max。所以很明显它也是一个二维单峰函数。于是三分或者一些启发式算法应该都行。

[mstczuo wrote on 2015-11-28T13:36:43]

---

一个粗暴的办法：

首先二分答案 $c$，画图分析一下，发现满足条件的点是个六边形。然后你把六边形切成一些三角形，其实就是问有没有一个点被盖住了 $n$ 次，扫描线线段树就可以了。$O(n \log\^2 n)$。

[ftiasch wrote on 2015-11-28T13:47:14]

---

@mstczuo#2902 
没有严格的单峰，有很多相同的值，
不能使用三分, 也许斐波那契数搜索...


[baodog wrote on 2015-11-29T06:29:55]

---

@baodog#2906 刚刚打了一个表，发现的确不是严格单调。不过三分应该还是可行的，因为取一行或者一列，有一段区间函数值相等当且仅当这段区间的函数值是最小值。对于每行/列的最小值，也满足这个性质。另外，有个没证实的猜想，就是取一个点的八个方向相邻点的函数值，最小值一定是朝着最优解那个方向去的。这样用爬山法应该可以搞。

[mstczuo wrote on 2015-11-29T11:21:04]

---

今天好像做到这个题了，没看错的话应该是[2015 Dhaka G Honey King](https://icpcarchive.ecs.baylor.edu/index.php?option=com_onlinejudge&Itemid=8&page=show_problem&problem=5364)，改成$\frac{f(X, Y)}{2}$就可以看作是六边形坐标系里的距离。

六边形坐标系（正六边形）类似于欧式坐标系（圆）的情况，可以二分答案$c$，转化为每个点向外扩张$c$得到的正六边形求交集，交集里存在点则表示答案可行。

六边形坐标系比较特殊，可以将每个六边形化作六个半平面的交集，是关于$x,y,x+y$的不等式，分别求交集之后，如果存在$(x,y)$满足关于$x,y$的不等式，再去用最值更新一下关于$x+y$的不等式，就可以知道交集里有没有点了。（求个半平面交有这么麻烦么）

时间复杂度是$O(n \log c)$。

[skywalkert wrote on 2016-10-26T17:19:01]

---

