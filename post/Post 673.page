# 2015-2016 Petrozavodsk Winter Training Camp, SPb SU + SPb AU 

题目链接：http://codeforces.com/gym/100956
想问一下B和K的做法。

K：我们做的时候把 str = S + 'A' + T求了一下后缀数组，然后对于S中每个左端点右端点最远延伸到哪，就算出S中这个左端点对应的答案（实现的时候就对于这个位置的后缀计算它和T中后缀的最长LCP），然后统计一下，然后错了。是想法错了还是实现的问题。

[evilgeek wrote on 2017-03-29T12:45:20]

---

B 的话。。。稍微优雅一点的办法是考虑 duality（就是把点 $(a, b)$ 变换成直线 $y = ax + b$ ），可以验证，两点之间连线的斜率，实际上就是对偶后两条线交点的横坐标。

所以这个问题等价于，平面上给你 $n$ 条直线，问中间那个交点的横坐标。我们二分答案 $x_0$，那么就相当于考虑 $(-\infty, x_0]$ 间有多少个交点。那么只要在 $x = \infty$ 和 $x = x_0$ 两条直线上，逆序对的数量就行了。

当然实际操作可以不用真的对偶。。。只是表达起来可能会困难一点。

---

K 不记得了，233

[ftiasch wrote on 2017-03-30T04:42:26]

---

谢谢叉姐

[evilgeek wrote on 2017-03-30T09:42:01]

---

K只记得是个SAM

[sevenkplus wrote on 2017-03-30T14:37:59]

---

