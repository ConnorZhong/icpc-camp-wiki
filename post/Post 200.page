# Nanyang 2015 J Walk Around The Campsite

给一个点数<=1000的简单多边形，点编号0~n-1，每个点有点权，从0点出发，从一个点可以直线走到在那个点可以看见的编号更大的点，花费为两点间距离，收益为到达的点的权值。可以在任意一个点结束。一个顶点可以阻碍另一个点的视野。求最大的收益。
求教怎么处理出每一个点能看到哪些点？

[vainman wrote on 2015-10-19T01:48:29]

---

对于每个点 把它作为原点 统计其他点到他的斜率和距离 对于相同斜率的只能取距离最小的那个点

[aclsh wrote on 2015-10-19T02:27:21]

---

@aclsh#1934  穿过了一些边的情况呢？   “一个顶点可以阻碍另一个点的视野”只是想强调不仅是边，点也能阻碍视野。。咱语文不太好。。

[vainman wrote on 2015-10-19T02:41:28]

---

先判断一下(i,i+1)是什么方向的, 假设这个多边形是逆时针的话, 对于一个角A->B->C:
(B,A)一条边, (B,C)一条边 (可不可以连需要看一下编号大小)
然后对B我们有一个极角区间(A,C)是不可以连出射线.
有这么一个性质,  除去(A,C)这个区间, B点和其他点P的连线不可能"完全"在这个多边形内部, 所以如果在内部一定和某个多边形的线段相交, 因此对于n条线段覆盖了若干极角区间, 这些区间的并是不能连出射线的, 剩下的对于每个极角相等连与B较近点。 一些边界情况判一判。

[yangyue wrote on 2015-10-19T02:44:35]

---

@aclsh#1934 走的时候不能进入多边形内部，也不能经过其它顶点。可以沿着边走。

[vainman wrote on 2015-10-19T02:45:33]

---

@yangyue#1940 看不懂懂，请问"因此对于n条线段覆盖了若干极角区间"这n条线段是指多边形的n条线段？如果是，对于一些点，所有线段覆盖可能会覆盖了整个周角，但还可能看到其它的一些点的，比如螺旋状的多边形。

[vainman wrote on 2015-10-19T03:03:32]

---

@vainman#1943 噢。对不起前面考虑不周。我们做一个离原点($B$)从近到远的扫描线, 碰到一个线段(这个线段是2*n条, 包括了我们要check的线段)的近点, 加入平衡树中, 找到这个点极角在平衡树的前驱后继, 前驱和后继是否与这个线段相交。碰到线段的远点时, 从平衡树删除, 看一下这个点的前驱后继是否相交.
这个做法就是n条线段, 在nlogn时间内判断是否存在两条线段相交的版本。

[yangyue wrote on 2015-10-19T05:18:21]

---

@vainman#1932 我们在现场使用的方法是，枚举一个点，其他的点以这个点极角排序。
则可以分成，1.插入一条线段，2.删除一条线段，3.查询一个点 三个操作。
用set维护这些线段，key值为当前极角下线段到枚举点的距离。
查询的时候直接看是不是被set的第一个元素挡住了即可。
一些case要注意，比如三点共线啥的，这题好像不卡精度，写对了就能过……

[AngryBacon wrote on 2015-10-19T07:09:16]

---

@AngryBacon#1961 我就被卡精度了TwT 最后几分钟乱改精度竟然过了...

[wodesuck wrote on 2015-10-19T07:35:32]

---

@wodesuck#1964 那值得恭喜……但我的做法确实如果他想卡是能卡的，这题数值有9位精度要求太高，交完我都做好了写有理数类的打算了。

[AngryBacon wrote on 2015-10-19T07:40:06]

---

@AngryBacon#1965 除了DP值的记录之外可以全程整数吧？

[sevenkplus wrote on 2015-10-21T22:07:06]

---

@sevenkplus#2065 我艹，输入居然是小数。要是我我也用double了。

[sevenkplus wrote on 2015-10-21T22:09:02]

---

