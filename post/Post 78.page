# 2015 上海赛区网络赛 F There was a kingdom

求教这个题是一种怎样的姿势

[karin wrote on 2015-09-26T11:38:39]

---

机智叉让我随机10*n/k次起点

[lostRating wrote on 2015-09-26T11:42:53]

---

@karin#671 

我想我们都知道，这 $k$ 个点都在凸包上。

那么我们现在枚举凸包上的一个点，破环为链，就可以 $f(i, j)$ 表示前 $i$ 个点中选了 $j$个，转移就枚举 $i$ 的前一个是 $i'$，把一小块切掉。
这样复杂度是 $O(n^3 k)$ 的，假设你枚举起点的话。

一个稍微好一点的方法是，因为有 $k$ 个起点，我们随机 $c \cdot n / k$ 次，没有随中的概率是 $(1 - \frac{k}{n})^{c \frac{n}{k}} \approx e^{-c}$ 。这样复杂度就会变成 $O(n^3)$ 了。

[ftiasch wrote on 2015-09-26T11:49:30]

---

@ftiasch#677 多谢叉姐

[karin wrote on 2015-09-26T12:12:31]

---

好机制的随机……
队友用倍增的方法搞成了$O(n^3log(k))$，卡了一下常数过的

[wodesuck wrote on 2015-09-26T12:35:03]

---

@wodesuck#681 倍增是怎么做的呢？

[karin wrote on 2015-09-26T12:44:47]

---

虽然开始在鏼的提醒下我是想用n/k*常数次随机做的。
但是这题好像时限挺宽，我的程序$O(n^4)$只要跑2.1s左右，就直接随便枚举90个然后就过了..

[jiry_2 wrote on 2015-09-26T12:59:15]

---

@wodesuck#681  巨巨 求倍增的思路

[GLSilence wrote on 2015-09-28T02:28:16]

---

@karin#687 @GLSilence#829 
待我去召唤一下队友（自己装不了逼TwT

[wodesuck wrote on 2015-09-28T03:36:36]

---

倍增应该是这样的……

设 $f(i, j, 2^k)$ 表示在区间 $[i, j]$ 中选择 $2^k$ 个点的最优解，转移的时候就是枚举 $p$，把 $[i, j]$ 分成 $[i, p]$ 和 $[p, j]$，各选一半。这里复杂度是 $O(n^3 \log n)$ 的。

之后枚举起点，用一样的方法做。但是这里不需要处理 $k$ 个，只需要处理 $O(\log k)$ 个。

[ftiasch wrote on 2015-09-28T09:59:49]

---

soga····

[heckboy wrote on 2015-09-28T12:31:30]

---

