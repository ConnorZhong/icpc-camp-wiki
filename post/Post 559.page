# Codeforces Round #204 D Jeff and Removing Periods

题目链接：http://codeforces.com/problemset/problem/351/D
题意：有n个数，每次可以删除掉数值相同并且所在位置成等差数列（只删2个数或者只删1个数应该也是可以的），删掉这些数以后可以将剩下的数重新以任意顺序排列，称为一次操作。现在给出m个询问，每个询问一个区间[l,r]，问删光区间[l,r]中的数最少需要的操作次数。
思路/题解：由于第一次操作之后可以重排，那么把相同的数放在一起得到一个位置的公差为1的等差数列，之后的答案显然是元素个数。所以需要判断初始的时候，是否能一次删光某个数值的数，也就是需要判断初始时刻是否有某个数出现的所有位置组成一个等差数列，请问要怎么判断呢？


[111qqz wrote on 2016-09-17T18:43:43]

---

离线回答询问。

从左到右扫描每个元素，对于每种数字，肯定是有最长的一段后缀是等差数列，假设是 $x$ 个，那么左端点落在第 $x + 1$ 个后，这种数字就是全是等差数列。
我们可以拿一个树状数组把从第 $(x + 1)$ 个数往后全部 +1，询问时只要询问某个元素是不是 >0 就可以了。

[ftiasch wrote on 2016-09-18T02:10:50]

---

@ftiasch#4310 没太懂QAQ  您能不能再说得详细一点。最长的一段后缀是等差数列是什么意思？ x个是说当前位置的数之后相同数值的数的个数为x? 第x+1个是最左边的数还是最右边的数？

[111qqz wrote on 2016-09-18T12:07:14]

---

@111qqz#4325 呃，说不定是我的做法有点问题呢。。（逃

我意思是，比方说我们考虑值为 $v$ 的元素，因为我们离线嘛，所以就考虑下标 $\leq r$ 的那一些值为 $v$ 的元素，那么你从后面往前数，肯定数到某个时候开始不等差了啊。。

[ftiasch wrote on 2016-09-18T12:10:00]

---

@ftiasch#4326 窝好像懂了，谢谢叉姐^_^

[111qqz wrote on 2016-09-18T12:30:57]

---

