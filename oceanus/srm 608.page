250
===

(1)取下限最高的凑C

(2)取上限最小的凑X-C

两种答案最优值即为答案

500
===

考虑如果一个点在两个环中 必然是a\^L这样的无解情况 返回-1

现在每个点最多在一个环里面 那么我们tarjan缩一下点就是个DAG

那么这个DAG里面环的最长路即为答案+1 于是跑个拓扑排序就可以啦！
